function [Y,Xf,Af] = tp01def6c7_e259_48b2_8c1a_01ea9e712816(X,~,~)
%TP01DEF6C7_E259_48B2_8C1A_01EA9E712816 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 30-Aug-2017 07:51:32.
% 
% [Y] = tp01def6c7_e259_48b2_8c1a_01ea9e712816(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-5454.91534726369;-869.204807020142;-780.471896742373;-460.20555521635;-234.31060487846;-540.291178237134;-572.142715533789;-620.900292310248;-263.800490630849;-210.82077992178;-258.183122033527;-286.590370604325;-190.32078243269;-271.750472270933;-218.521589353922;-373.104709120361;-120.218367860417;-258.8588473988;-176.115238468633];
  x1_step1_gain = [0.00034254044244578;0.00027748074658588;0.00080601324116702;0.00156677380853905;0.00168393926281428;0.00269046527889069;0.0019808499204541;0.00236361816544284;0.00245784730269614;0.00195235680232595;0.00282106579415896;0.00424658079482958;0.00317261769260758;0.00555458687461899;0.00429724736478087;0.00484270636687463;0.00333931608099045;0.00598913897545075;0.0038478300260404;0.00642488839732232];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.78590849020075270737;4.001507215752072355;-0.064031510485237044805;-2.4310818398975841959;0.30761102450248084539;-0.65792404389522574082;2.2223010281491202278;-0.39354981259298049689;-1.6584548040622988374;1.701696811785760044];
  IW1_1 = [0.41615395598462084914 -0.4571289283696383654 -0.12870560551697185492 0.5332747102354317148 -0.39469986503292903146 -0.091917990266491042539 0.43967744454436030743 -0.034364254477443748059 -1.3683068888442415645 0.87043236932906731251 -0.27364119910391049295 0.59888565892186640394 0.44648184817664904322 -0.25159111502712200314 -0.62486362461352495945 1.4791115206077243283 -0.60500153682786639298 -0.84861609982892372006 -0.78068854723852665334 0.7896420001081284612;-0.30532460515334258755 1.6997012231825607831 -1.2932913374051995259 0.1385188837447775545 2.550018234416082219 1.4878240219886369466 1.4012641506729299756 -2.670102694993814918 -3.1473673107824042816 4.7446344339586801198 1.1283497617369537824 2.5476770238657988621 -1.3866007871087353553 0.16044402783057126749 1.2750642191555781046 1.5230785273414277903 1.8475443232708463892 0.72332704167613304236 -4.4525814811669963689 -0.21010968377126654216;-1.8035596039795886991 -0.27429706083526594895 -0.21818079498176759512 -0.78970740529743588265 0.037578440821038075481 -0.078716797605055413567 0.33352682471837846734 0.10772382092307519752 -1.2369916500836073414 0.81666284988225879005 0.50366847041674711605 0.84148581121235066504 0.38147738274007886305 0.65148705070395740435 -0.86015902788139442237 0.89255256878602751147 -2.5536837588165783863 -1.8394033402271270372 0.46614274816845113758 0.37576676735880765179;-2.9932083145720365103 -3.7006186270266563376 0.42360455585943396217 -0.86519349465193040594 -2.7419881892015238734 -1.3992431146359185501 -0.47351728008061616526 2.9715539757112545693 0.87111900955400278779 1.7626514363451259992 -2.3248385875609622886 0.95787120762437971688 1.5619257624606621704 0.10007371936657377676 -1.5056003282861509796 -0.35471353125453303212 1.2903663092699839687 0.38899818438102184981 -0.57089992688304702639 0.41759359662922801437;-0.85842567409046521831 -2.5052903952229397255 2.1934806728326794456 2.3596169484408280326 0.55419185962842532067 -1.2477568449533062989 0.39907538915381696176 -2.9097010851484417238 -0.92796116617109414282 -0.35309620043110734322 -0.35182931204131318026 1.0003992084184660794 -0.31584681884925336348 -0.094290283264365476468 -1.6429788102682862938 1.4453049522192531473 0.086940773715199981542 -0.020795328561357323549 -0.2740925205377264251 -0.62457479383695024833;-2.9107216320359841077 -0.36745655672385213464 0.98359776646378471732 0.28544913367655888603 -0.30608473858313683946 0.54554114621325977552 -0.22755844945828004877 -0.089206459573914570482 0.47921451914485668766 -1.0701482535793280793 -0.26671073614672397012 -1.0684211470420592605 -0.64901458503169595637 0.083204853466378195237 -1.0348766592895586314 1.6547796342878167142 0.076846316925130483955 -0.91924758899649794408 1.3661590678100468121 -0.61504738433450678592;5.3740390251662129018 1.1213932030671889262 1.7428481059572205059 -0.85769781415515677914 1.7714990614873096231 -1.7359179144990752874 0.09694750168792062861 -2.3518441524653264096 -0.92414237289866940639 0.58006462138279846208 -1.0451287025672109099 2.1335720610216024618 0.49673081184539608079 -1.4298156330455700225 0.3290575477156086337 0.89064122920730603994 2.1156984353686083544 0.09088508476601203645 -0.93495518407204236677 -0.54446202631204343447;-0.47367247593913963666 -0.4357091234747099695 0.092310127567729050035 -0.21842951815136238403 -0.7956080511778669262 -0.034668645713748148796 -0.63756429230661004759 0.3640087748774099019 1.5402130264782043501 -0.26340248056813436728 0.49977624465918540908 -1.9983001372571425058 -0.75525041094823219812 2.6043562638398505271 -0.42051086779275004268 -1.0375852717568230243 1.2639625980845659026 -1.6464423633862794727 0.61858345726084806859 -0.26109764882298380773;1.6619216065708806163 2.8702882766318422725 0.42721811956125321785 -0.81034510109400126332 -1.1741816722925453309 -0.66501530401176689455 -0.80796196160716515777 0.63949186270531166443 -0.66005324556997346797 -0.17411681104671405951 1.4382804715457064848 -1.0999345549157484303 -0.12592704825509010158 0.52625817098205140976 -0.46850740781391181367 0.31525673961216216235 1.7139617172725898353 0.096124944337667550531 1.0924403026503219927 0.30182889981478716601;0.40403948047571147661 0.26359322150787689587 -0.28372769162040528679 0.057277171541442011005 -0.18270164160163096523 -0.57947822468578391586 0.26440154390153003394 -0.74922041943977946143 0.16112506019430736237 0.26937252130031730246 -0.29434168934848176091 -0.44243003210739562103 -0.55939128136742044539 0.69856833411017082991 0.40236079041776434684 -0.38527981320427456824 0.25986661203802480236 -0.58878882544416122347 -0.15446332310280716515 0.64208014164534199519];
  
  % Layer 2
  b2 = -2.4886482252352144506;
  LW2_1 = [-1.3684096813150188332 5.6117070772259110001 -3.1062742549255837332 -5.3169917709059832944 -4.2673277702128702416 3.0028689781494160016 3.2602963789376833148 3.3362052589374320277 4.7646529597723796812 -3.0009927569225909316];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

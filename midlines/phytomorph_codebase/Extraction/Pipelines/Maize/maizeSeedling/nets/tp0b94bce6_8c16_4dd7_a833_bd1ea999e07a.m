function [Y,Xf,Af] = tp0b94bce6_8c16_4dd7_a833_bd1ea999e07a(X,~,~)
%TP0B94BCE6_8C16_4DD7_A833_BD1EA999E07A neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Sep-2017 14:26:52.
% 
% [Y] = tp0b94bce6_8c16_4dd7_a833_bd1ea999e07a(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-839.604414481267;-7316.69285265061;-873.097427232648;-1646.05375716081;-423.333970720151;-346.884767278008;-410.542636124638;-168.317352166514;-342.308065266719;-280.547165434115;-123.367532175676;-246.980329538442;-418.782145732694;-134.94185553111;-166.270203945351;-165.943873492981;-201.347350487941;-147.229750402483;-715.253580950921;-451.498000639694];
  x1_step1_gain = [0.00043525835929838;0.000254266760874674;0.00034735300303884;0.000777513986910236;0.00172505617054034;0.00206247464333952;0.00302249934878054;0.0032309825223833;0.00220614635584282;0.00242812082773063;0.0023189737723535;0.00407495867726199;0.00341201206501293;0.00551378415971639;0.00648970220781273;0.00620026189110762;0.00633602455501661;0.00774864116843306;0.00243421857993274;0.00313801600663511];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [0.84885843002093153142;1.1765971100795293847;1.1942518822926473376;0.54937113410277882419;-2.4274922030558454544];
  IW1_1 = [-1.2388423680681410755 1.7748057447226923689 -0.97768307651098440569 1.5938516835087184198 -0.22664749355800173358 -0.34131484379933996198 -0.20340206816038536308 -0.095596474886063917409 -0.056797067764707866167 0.6938685544906069147 0.95167109659359527818 0.20912710076314436347 -0.64857864928582398267 0.39336326386016867707 -0.030422101983716021839 0.34204619761584426074 -0.49244054342238940958 -0.5537702873048958585 -0.38444806210973930805 -0.49682034187746176856;5.8935844448317356026 0.80579528687493584549 1.3071538537237012978 2.8177322328280811625 0.54744331642165255936 -0.25403141724843664173 0.17849299061436027514 -0.17700637867135995962 -0.030204461785716774785 -0.11438382736327604161 -0.57898665423518513862 -0.077873121744015783019 0.52661974513413090104 0.21185024280792350004 -0.29902752024452955437 -0.081690024723422863251 -0.26652591063472580446 -0.14874957885657819068 0.31335435616348039645 0.34930499319597729802;-0.40559540283008488348 -2.2730153407908169072 1.4115658495642027237 -3.4391947949647456717 -0.68351443344160367488 -0.63689129286827039778 -0.30590402356309071008 -0.44653314336319238631 -0.13142615804638294041 -0.65081559382035525374 -0.41804314840326711744 -0.2644604000902985308 0.67154894705946477362 -0.74312239732921370194 0.43491186719160968011 0.28398125595002615684 1.0202637670580501084 -0.30860952916361678033 0.39950143925318071236 0.29157399299747482901;0.91649801672837105659 1.1451392043219370542 -0.7633643787769439637 0.7620393763290759237 -0.098667090143343655351 -0.38910450886267938797 0.15067401438429989247 0.083976555422302714971 -0.35863703687014003574 0.021360262664566049412 0.72263788542053764008 -0.045720927420832724319 -0.48502970638706088824 0.14954025860195160891 -0.12824747804638964022 -0.19923684532798144331 -0.25331808481556017387 -0.090317719159322892852 -0.34743232156887077222 -0.67164720607800965091;-6.2130669159395548462 -1.461921856820480814 -1.096018804390110013 -3.1715240123189358812 -1.0057614434109483081 0.20111791743827131529 0.16459949880826277302 1.2083003296045811137 0.61789524089564140663 0.87470690383327365236 0.60770559461695616843 -0.40366336946229219862 -0.50736431406838533587 0.5257558552069975244 0.3918852749613994102 -1.5019845896376542438 -0.9721930971683008238 -0.42058374307453216812 -0.92027225015906721772 -0.09145047718522249236];
  
  % Layer 2
  b2 = -3.9744956786788940839;
  LW2_1 = [3.1019179783285033558 4.3200406956311772078 -3.3056673032933390211 3.9288060451286028751 -6.1543776077273637526];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

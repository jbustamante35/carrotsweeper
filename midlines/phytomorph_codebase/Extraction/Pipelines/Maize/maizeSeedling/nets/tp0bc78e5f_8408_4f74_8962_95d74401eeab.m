function [Y,Xf,Af] = tp0bc78e5f_8408_4f74_8962_95d74401eeab(X,~,~)
%TP0BC78E5F_8408_4F74_8962_95D74401EEAB neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 07-Sep-2017 16:13:59.
% 
% [Y] = tp0bc78e5f_8408_4f74_8962_95d74401eeab(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-5454.9153472637;-869.204807020143;-780.471896742376;-460.205555216351;-234.310604878461;-540.291178237134;-572.142715533789;-192.819908210792;-263.80049063085;-210.820779921781;-212.78401520665;-286.590370604325;-190.320782432691;-193.663740648594;-194.470619647335;-373.104709120363;-213.719449945748;-260.914631799827;-176.115238468631];
  x1_step1_gain = [0.000342540442445781;0.00027748074658588;0.00080601324116702;0.00156677380853904;0.00168393926281428;0.00269046527889069;0.0019808499204541;0.00236361816544284;0.00245784730269613;0.00195235680232596;0.00282106579415897;0.00424658079482956;0.00317261769260759;0.00555458687461898;0.0042972473647809;0.00484270636687465;0.00333931608099042;0.00598913897545118;0.00384783002604034;0.00642488839732244];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-4.3760762163068989139;0.25700006679583214941;2.226409257083768356;-2.4752462286896221855;-1.3682767671176225832];
  IW1_1 = [-0.74128204234753936053 0.22334491527879907213 -0.14566995681141287067 -1.05681892614625772 -2.19451039997799624 -1.0393288217667537854 -1.0109857870113014844 2.156266089948835063 -2.3253661820865527687 -3.3000902877779347833 -2.9677674458255993706 0.68422447760601812217 2.1545662101746074768 -0.25827266224811540329 2.6414196900932305212 2.4942650025511614587 -2.5525413022426448606 -0.14476485031012145677 -4.2372476399071707931 0.89249634686790868532;-1.7599803261525499565 -3.2054959675116951878 2.7006974944215937917 2.8945764368750666051 2.3957236039343667855 -2.3584062506764835732 0.16730701760161867386 -3.1127752738270313415 1.1202076111031360472 0.24869662670374007019 1.1256392913055566218 -2.6355249525565489499 0.30611786012712832727 -1.053107758821360207 0.95160069554021997629 -2.5752181410999015476 2.6046486955065422109 -0.077843998145500956087 1.5267846548799079986 0.56389193753537769638;2.4294889936182095802 3.1022266177718460511 -2.6344661384746252963 2.143536177839330481 2.9298344580545778726 -0.41013030164990560422 1.0190492716735644052 -1.9302277937176799405 1.9361610989224318224 -1.5909276921420851814 0.64334562237561687681 1.7390872488460047407 -1.7962896450117322722 0.12668048969263356884 1.2797379518317302249 -0.2601725959683396372 -1.8261542542135804634 0.59919745787732314746 0.50999469933618590822 -1.3679573173454278034;1.1906835886394269153 3.6718387077475171942 3.2328843356618395255 -1.2936226027639363689 -2.3785561482028105829 -0.040252392733028656557 -2.0028448473779674188 -0.42596003846259644643 0.47033278027788422149 -2.1619015495399165339 1.12376639948066126 1.1611737299437667748 0.48683783272871300474 -0.24053975090091858635 -0.2769758195154107816 -0.18391502197389147932 0.78065815865502807824 -0.26211299420322453635 -3.5409107442348677353 0.66664731803538190835;3.537176755081185231 4.5594952661286036744 -1.3936778022415814426 -1.7860191217973140354 2.2849262847794427067 0.22145943077312810199 -0.99877384850626060864 -0.94022407725154411029 -2.534467504733238119 -0.62566139160238265493 0.46554988540247121964 -0.048107492626345019215 0.88472426647045931958 -0.23425236196602383654 -0.54245447762961152005 1.6434441556845238441 2.5494357491499601842 -0.61156814829529015931 -2.2449532408093597624 0.34041175742249157876];
  
  % Layer 2
  b2 = -0.37498171168579452761;
  LW2_1 = [-7.5609164235633450346 -5.8571212573411228774 5.3863163833872880204 6.6967099634487246007 4.4216145305292320344];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tp0cb7f998_ce3a_499f_a76d_638948ba7fb4(X,~,~)
%TP0CB7F998_CE3A_499F_A76D_638948BA7FB4 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 31-Aug-2017 15:55:26.
% 
% [Y] = tp0cb7f998_ce3a_499f_a76d_638948ba7fb4(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-5454.91534726369;-869.204807020144;-780.471896742375;-460.20555521635;-234.31060487846;-540.291178237133;-572.142715533789;-192.819908210792;-263.80049063085;-210.820779921778;-258.183122033525;-286.590370604325;-190.32078243269;-271.750472270934;-194.470619647336;-373.104709120358;-120.218367860416;-260.914631799833;-176.115238468634];
  x1_step1_gain = [0.00034254044244578;0.00027748074658588;0.000806013241167019;0.00156677380853904;0.00168393926281428;0.00269046527889069;0.00198084992045411;0.00236361816544284;0.00245784730269613;0.00195235680232596;0.00282106579415898;0.00424658079482959;0.00317261769260758;0.00555458687461899;0.00429724736478087;0.0048427063668746;0.0033393160809905;0.00598913897545082;0.00384783002604041;0.00642488839732226];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.0806416085011985029;3.0683618287664633506;-0.84077135603448316381;-0.19760820798026892953;0.75224822646385103297;1.7485596814459298809;6.0078267460147065648;4.5361354015109629501;-1.1401801983062112011;2.3359659356339488312];
  IW1_1 = [2.634693901276172312 -1.1859456797732170763 0.75599439606211660259 1.3127642038523754664 0.35001704062917976534 -2.321678587661488713 0.035652310887287444463 -1.4324156320655767605 1.8793017971742715932 1.5264619445144422816 -0.74246468068752091707 2.0187805392017716954 0.12363450936012762571 -0.90452538915712976664 0.62084316131354777557 -0.11711053011486687037 0.092444299974472843306 -1.7174178083668611983 0.94154822919860192698 1.1223263742435329871;-0.91748518278517077196 -3.1744539435744303368 1.8844747883079848716 3.3419166847070211901 1.975660641494519032 -1.8536334647752710225 0.75692629305156389208 -1.122502992329591498 0.49937803133200098227 3.1160404571352104952 -1.1017866171611663262 2.4728635715806142059 1.182570539112253849 0.11921546056214238352 -3.6507862976144829226 -0.8879505674762135925 -4.1420283004025577611 3.2650318129702582404 1.2790943947633641731 1.4546251683247479747;0.80227656206159358998 1.6634556379377756219 0.76077646453712455266 -1.3644612232016419817 0.243121159266495801 -0.82755408327915713773 -0.89733830864203989464 0.41402617773559763359 0.54933424894947691097 0.69861023976559633031 0.72500429820797207547 1.4076770717946942568 -0.04380861207036460675 0.18256371482346717139 -0.47252141407539705042 -0.082545883624954949354 0.59038559953327951479 0.25580943326019750517 -0.82025704713446812022 0.10500619668292866804;-2.0435985170115156251 0.94340063431916154624 -0.95553165605821621664 -0.092832678941454097044 3.2317617725319580657 -1.7816633955158418523 0.45259210215689493761 1.2760057415594010521 1.2839117887572633059 -1.8685937978585547281 0.28675715373713334122 1.007786192810967929 -0.57347372653365369377 -0.30633437731196827558 -0.1048088882238025904 -1.2539633231909130817 -0.41560913062189946965 0.88146289615481387969 1.6115047528111217101 -1.5940654615716685072;2.6924330368355979815 5.2613395813574168614 -0.61455726854063985609 -3.5326904922544777321 4.6409120003321611136 -1.3473196385403010122 -0.63029153000328685952 -0.68888428757993469542 0.24777153311989211226 1.1766596226193617447 0.25734884422402398707 -0.27298311923271767476 -0.42008961530022503883 0.11120403473157389196 -1.3493265857492062754 -0.85977646623750658694 0.99244217130976286612 0.44544905780481197644 -2.7820528904428831751 -0.36315849299481450796;-0.50041358411714964571 1.5125716059300076122 -0.0048958140991540574291 0.91985748475378836808 1.3800787577622972702 0.55636320674115036233 0.064800738002138605354 1.6997087271610757941 1.8834033269761676355 -1.1027317895609101139 0.028500728939136233536 0.79883151847210065455 0.022888003012728579122 -2.2461326672521368941 3.1407825248179612743 0.013726311042197122253 -0.049325459873693099089 2.7597201128539783355 0.11587813763376769716 -0.51010483313293941698;3.9426332877171925695 3.2148383537905442786 -0.085068046829624113792 1.4466079046045499101 3.0401182155894814763 3.2149042909736325058 0.087946429891834349002 -4.9374762593624321738 0.30320275469839136351 0.44585816964173397015 2.7357507483176144447 -1.0046891304966041325 -1.5403242517870339157 -1.1174595780501672682 1.1197615109791667631 0.078776907158621040095 2.5891297204064871451 1.7871281527137095058 1.8679056939785290137 -0.8447585808576667521;-0.038395285522789895927 1.9353028234101257166 -0.98351318684250810254 1.6824730320827216978 4.095090963982001675 0.72576941802699768136 1.6299778298130693788 -3.6961491660336243115 2.5964328903242477331 6.6318351888622357748 0.5945738808336746839 3.4248226893727178322 -2.3933926372254759052 0.94416758171864190174 1.1923063459773053374 -1.3180356536214679064 0.35180238786507889159 -0.29499044662144113804 6.5322667311760884701 -0.3497342789599195978;-0.2090604385422142053 -4.2003993781645645456 1.3708159943902715749 -2.1225451757018656274 -3.6220407168004311593 -0.51245201518246064065 -0.6857386082761868229 2.2625620150049643442 -1.0760742661097610906 3.2556982235222133859 -1.2876098691660544659 2.0488044447328883635 1.0160644538258718494 0.1428849667584936034 1.022054652231279448 1.5663061718876249984 2.5184438654427334647 1.4277976505404936791 0.26186522903465664358 1.7621096150326169827;-1.6455069967950948229 -1.4097232764476304023 -1.814200813054966277 0.14377930834113836212 0.52781681290450344068 2.5421823397878049455 1.3164980302288320502 -1.8932759538585584025 -1.9129991884848212003 0.56535658672071797959 -0.48571317110256212457 -0.19162948824601744313 -0.89157321760179197856 -2.0015821760425231979 -0.56735848042991887663 -0.29753571371563281023 -2.9166081604648064207 0.78307113884020662642 -0.12486673326109413995 -1.779138556817891903];
  
  % Layer 2
  b2 = -4.4373427352179275474;
  LW2_1 = [-3.2376739692400664516 -3.6584459418512995654 3.2981520332252896033 -5.0626526899688597538 2.9376917294292193006 3.6964607299991056877 5.3437990867237514792 4.609396764810743008 -4.7872606421764629658 -4.7215629192668240321];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tp1c36916c_3f40_4c51_9699_c63e1ef4fd0c(X,~,~)
%TP1C36916C_3F40_4C51_9699_C63E1EF4FD0C neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Sep-2017 12:45:43.
% 
% [Y] = tp1c36916c_3f40_4c51_9699_c63e1ef4fd0c(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-2001.76879548539;-1846.28602050405;-1096.59977942709;-1127.27896682562;-718.635970677915;-534.73657908755;-717.539895324646;-474.328050496923;-408.756773605262;-437.689914113482;-597.158358369101;-384.721680725407;-357.743301501242;-305.701917871542;-262.500890231169;-420.955237007933;-168.878309979165;-299.148398756992;-279.306010526108;-382.085749121024];
  x1_step1_gain = [0.000250772026915415;0.000457175383291266;0.000795694570296745;0.000975455655635301;0.00136867839470428;0.00177765334299387;0.00147664952758212;0.00196526984478522;0.00211681540578911;0.00191395299404995;0.00213803411115015;0.00313745816598813;0.00239499394158854;0.00262802245354391;0.00340299377226973;0.00307580218448467;0.00420342200465333;0.00353937526659766;0.0030569613569622;0.00320422591704728];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.3823353710478578638;-0.050694484351376994935;0.77701000338710635162;-1.6075599963515290192;-1.8812533132879840636];
  IW1_1 = [-1.5312338116704919955 1.5034616092940262799 3.7912552839556887818 1.2446082543721825875 4.1879273144094115722 -2.7927803894447991162 1.8560458298229092211 -0.21767464322806576171 0.15059309647287916212 -1.9319483051616019864 2.6482081378366029156 -0.51051356279488790957 -1.9690174402247964114 -1.768909887938728609 -1.6807113737918630836 2.7579811989787135218 -0.45209756038636933484 0.69456862963675802813 -0.72631177231526022897 -0.57871620174422089278;1.0190631254109552284 5.1011425470287470318 -1.3354587483959634575 3.7727848939125059324 -0.54167275508412005003 -2.7440042055533977461 -1.2006396790752131842 3.9061652374403244004 -2.2771053662668339079 2.8609099240432018796 5.6730570820045587155 -2.5379021860625332607 3.9763680617037340248 -1.1397975645638320774 -0.49403787261535703212 3.2590238952617229806 -0.71472272183329343953 2.0671751264817399552 -0.39748875685458795459 0.31764152944619833407;1.216827622697889133 1.08161948078338499 -0.25100822608068334985 0.59705615962117097872 0.99429660289113097615 0.2308184569561936017 -0.50002388056109314807 -0.21004320055978789594 1.7467935932617864037 1.1857391374534618222 -4.1000922163319710734 -2.998275785000056981 1.2528953523185193397 2.7823449723546098689 -2.3401074944238704489 0.59942973516696951286 -0.19654843255204251795 -1.4381151206703199907 -3.792758434497500275 5.6898336930172987991;1.2600673234720034532 -2.8577993249749003013 0.93929635336643735322 -0.57610703255062467587 0.083615963521312189344 0.002142726663393172172 1.5248602810048512701 0.31978659546395438174 -0.88616390285790169745 -1.9750164316460019354 0.75742466688537490871 -0.30195194131516306379 -4.0976734852276948118 -2.1325308133915421571 -0.9369166708782145081 0.78689592300496824517 -0.91402305931756411272 0.54979633748903766755 -1.1943965179975495339 0.78459072646957006558;-0.22737518241629020577 -4.8659774119780188073 1.8498682522448957055 -1.2226604182705136381 0.60156226337976193008 1.0120375183867611479 1.8990532995114892678 -2.5265079609607372646 -1.7014455393923599846 0.80567100900384824858 0.12947930639752489035 -1.0698697213385306437 1.3727980809290534214 2.3095787877607270033 -0.13204030399344424129 -1.7521639215039970239 -1.88411683004992625 -1.8521654916721517203 -4.3070270844747540195 3.7321431071955157854];
  
  % Layer 2
  b2 = 0.29573038138136592545;
  LW2_1 = [6.9666014686745176832 -9.932703336959823659 -6.2947944683008723032 10.638784004494834079 8.2396450403169279042];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tp25f8647f_f27a_48f5_9055_3ded46b4af27(X,~,~)
%TP25F8647F_F27A_48F5_9055_3DED46B4AF27 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Sep-2017 13:52:11.
% 
% [Y] = tp25f8647f_f27a_48f5_9055_3ded46b4af27(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-6506.15769134605;-1968.46879957595;-1377.69545894784;-1183.76616946853;-711.642931835562;-672.522601966803;-447.378118638318;-420.527401865322;-682.765477573461;-458.333844314367;-622.812481590511;-410.039334332747;-387.578117402323;-429.961560001113;-373.705895665994;-359.072122656298;-277.037336897485;-301.078315473956;-400.794724948385;-285.384637074656];
  x1_step1_gain = [0.000244911356138662;0.000507837665104201;0.000859080031338269;0.00102992699402406;0.00116476174985821;0.00153608271588201;0.00186490882819871;0.00229564725234539;0.00140550898923532;0.00187872252206335;0.00209870879134679;0.00237421637966938;0.00249683918257887;0.00271795669482115;0.00287765136194784;0.00323536160952186;0.00314965135524183;0.00399550556362189;0.00295376821702649;0.00375051214875974];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-3.4023044781377516088;1.7301982326034610615;-0.22025125332641384834;4.4025445742157023332;-1.1478123223607519243];
  IW1_1 = [1.4557665722833068589 3.4398638471099958203 4.0345165749953562084 1.3878450630477328076 1.8745999024352821838 0.27755844065640161711 1.0460432008582445373 2.729460272605237936 -9.6983305999340103654 -2.6785870939002842661 -1.3656474200939079378 -0.79581759959123121728 0.3777876745971636141 0.73266031452853730421 0.61310434626922061252 1.441593346793583974 1.1138269210920099805 1.8636863623184958261 0.3498835758864136114 -0.85653889544693895264;-3.5615857167867313038 -1.2034956569014521044 -2.3206677241049136207 -3.3407677760191125671 -0.28799157269562492001 1.064021060329888746 -0.64018414192244921246 -1.1297036477052850856 -3.6718968208431297384 -1.1530525047592021792 3.4275349209245540294 2.1159789838483842317 -0.78367739344869136175 -1.3123400193848400175 -0.55391861608551784535 0.76591659582077853408 -3.4326091312350759388 0.96717035994661804121 0.41495602765373168497 0.72043652996286011714;-1.3770364951711051571 -2.5538422260270063902 -0.69025087104743054756 -1.5395447639398822659 0.90487389633273895839 -2.0322346560752935218 -0.69156862992936052326 1.2393315669864668482 -4.464750388891006061 -1.2059633099070501405 1.9525715484932006927 0.030589798523276912762 -0.37466434360870704001 1.0185591543662044778 0.71070180900712121019 -1.5326163204137956964 1.2341991511425578487 0.18248890806759035521 2.3420352084508282431 -0.57639285774024306974;-3.3644059956622340835 1.4783939418658700315 -2.7528824616080176391 0.26286454620917620861 0.83369383416977504986 -0.26351435708280551706 0.65542892878867931028 0.39533489525745901805 -4.993547157077061982 -1.5020334157958208365 0.84729154512851057035 0.36274136846455262706 -0.57479887625213643698 -1.4239044176296737909 1.6491662624308269791 0.61084152041945094513 -0.24251273654745053587 1.7437561837758590588 -0.77004894073144636302 0.42306980514377440228;0.12507185971693798865 1.8058056022507353866 0.39362890891227342305 1.7914817593152545516 -1.4915529140297285604 1.3605225465242984928 0.87177878801336183834 -0.32985977203028638005 3.9356922634809019534 -0.75082102407196149585 1.1127862372688488435 0.64721697029975533422 2.7010760868945795643 -6.5449102668267347127 -0.65178483938033204836 -1.8014620597066508534 2.6737505054808088367 -0.64145710990250415229 1.5667000927072711747 -2.2654498828104423502];
  
  % Layer 2
  b2 = 0.15924775117312392481;
  LW2_1 = [-4.5762811847991535785 -4.2778440185401827023 8.7945030558123065134 -6.9678433963988091193 -10.222131435019170098];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

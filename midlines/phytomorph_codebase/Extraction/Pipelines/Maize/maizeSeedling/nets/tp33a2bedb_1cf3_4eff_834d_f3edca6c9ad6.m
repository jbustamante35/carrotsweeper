function [Y,Xf,Af] = tp33a2bedb_1cf3_4eff_834d_f3edca6c9ad6(X,~,~)
%TP33A2BEDB_1CF3_4EFF_834D_F3EDCA6C9AD6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Sep-2017 02:22:43.
% 
% [Y] = tp33a2bedb_1cf3_4eff_834d_f3edca6c9ad6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1054.92998109303;-3159.48627075362;-2114.7808760494;-1423.59192565959;-885.05794399119;-486.21206448605;-466.558771320898;-686.259228054125;-578.923214789103;-680.040226027847;-526.427101249691;-436.274101764843;-464.119415341442;-572.311544415315;-525.032869762636;-373.225105661535;-301.983936484963;-284.873458506228;-200.952843845987;-287.671508962935];
  x1_step1_gain = [0.000201853701047093;0.000358308876895914;0.000501068237842808;0.000831515796852234;0.00087930290309635;0.000967909908790066;0.000979217898324398;0.00108578915137916;0.00217066128634303;0.00165661710022776;0.00119050056045195;0.0016087609924096;0.00270230114420071;0.00170182021982356;0.00262305491334273;0.00249971191480289;0.00300944378896507;0.00354914054319085;0.00406898355464178;0.0031349095958513];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.2898067026084807374;-0.0049144297418661983534;-0.86168126596373995074;1.2073598110681897921;-0.99912502709619133157];
  IW1_1 = [-0.20101029438094283885 -0.2288495171718383514 -0.32864500271853785973 0.53618179475706273518 -0.22358480639477348872 -0.2767006015202349567 0.51239287722500637123 -0.61324501129115460696 -0.059821945380177300733 0.63876462951163193171 -0.60603066915570380502 0.17517734222886441331 -0.26149921314117857696 1.0762790059892410888 0.33936464007560973588 -0.33858395593890816544 0.49668101743280351767 0.57455456038692431786 0.20173362480520157236 0.41190491518181221453;1.3510157795222126342 2.2125301544628772632 1.2564927053298007298 2.7167753904878551019 1.9331699364104990568 0.15370247791531524428 -1.6421618465295504397 1.6100973936864395597 -0.83191843453427516408 -1.028828753951442021 0.97837540694442393097 2.0695859469472557279 0.24217679069061981423 -0.99483939949822242088 -1.3342514168174990363 2.3770530087243813 0.11846023813496518728 0.20250626828448103911 1.5078581405593707299 -2.1081958818221000485;-1.0545895095193849045 -2.6781243103608836087 -2.6916258146619864711 2.5251629037652181253 1.3568789731599675275 -1.4638129458948039296 -0.11485247763873712712 1.2927787350947443912 -1.9616960050535103832 1.2146797636396984288 0.19388909086351410749 0.98600760355499084131 -0.0054699754769427511025 0.48039939279386717486 -1.8043891462712571272 -3.1965568793378160706 -2.0581931392819745597 0.21563828546444713252 2.0714483855503935672 -1.0559302042575304803;-0.61020497164346843011 -0.79837947619904658936 0.31986985556693281474 -3.478181524788682033 -5.1561643217549226748 -0.56039699721622648898 0.82690053812972275082 -1.8334713657714161172 -1.0116022642469304493 -3.1049912074755425806 -0.84007672390871779289 -1.4551126763543682507 0.031869917714858357616 0.62810781981533736484 -1.6273219302123604901 -1.2318991441285513933 1.7614282814935982024 -0.37193585140752405405 0.93146740322096643894 -0.1573350293415798351;-3.0151426857337524368 -0.14173877207306384562 1.5041468015097541056 0.093631090437481384603 2.1254515590997069552 -1.6842414392491420472 -0.41963502603516805722 -0.056172206405503570525 -0.70721409166299420423 0.28637378339475577649 1.8535782551380588501 1.2948143552017421509 -0.8533810387486070459 0.91835750930725523755 -1.6495580861468603917 3.1971982100571931795 -0.046236067157390071947 0.53437592872330430538 -1.3353552282125304984 -0.34621080757232874925];
  
  % Layer 2
  b2 = 1.5795690232487527016;
  LW2_1 = [3.189326354689514087 6.3304409495906135419 5.8848415095362227589 -6.58365949918912019 7.541788765617126522];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tp37b6dad6_92b6_4c57_af6c_7a13bc44d5bd(X,~,~)
%TP37B6DAD6_92B6_4C57_AF6C_7A13BC44D5BD neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 05-Sep-2017 07:26:17.
% 
% [Y] = tp37b6dad6_92b6_4c57_af6c_7a13bc44d5bd(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-3289.74882371951;-1498.84051842406;-977.818006857931;-2473.29678142316;-579.957172766839;-720.151909430016;-474.399996307269;-522.24224923224;-420.226401116415;-417.475292942102;-306.200888877845;-295.559587155038;-285.018101170375;-376.41158617709;-312.430500619521;-321.397730757893;-231.052600123327;-207.605781402891;-300.292838284031;-183.531087713643];
  x1_step1_gain = [0.000377693156370527;0.000577456077299579;0.000763241531595339;0.000656175798642299;0.00207889551360641;0.00132289146378878;0.0021050120182425;0.00188095402340317;0.00237297796658717;0.00258788322162196;0.00300539389135356;0.00292429008303262;0.00346972867854874;0.00273531031890043;0.00311974005335499;0.00346508516159045;0.00478122411926401;0.00448287798328078;0.00393490060972028;0.00521177147160679];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.196943197708494111;-1.6183790929576884476;3.520595976471198707;1.5892626428503893177;1.7318185084312049948];
  IW1_1 = [0.63597130175132765562 1.0232087036982320249 -0.45084484621154952144 0.45121519132762766269 0.084984514564567903427 0.988055576046163897 1.8989521243193416833 0.13020645963997595773 1.174321683405641803 0.32311653342190399529 -0.42479396037238920103 0.76005707092048513385 0.080578106358603518444 1.0859436488495268769 1.491376139042444926 2.8972205269860622501 -1.6837028971582563841 2.3993632962010176257 1.51466888586421633 1.0435979962928056963;1.5509977931963916387 0.85295917973530932521 -1.1290594042764323657 1.4821486926723224098 -2.3921562999633927404 -1.2362723079776054558 1.760541068205673465 -3.8164521544896383709 -2.0281690271021526328 -1.8026381040486303409 0.62041911559370754858 -0.1177817437182940713 -0.94124018881965920702 0.17645629219052544334 0.79539495898968726184 -2.0905298075489939791 1.8583593856017297519 -0.063039728131660269228 -1.8249901594597766064 -1.6629739844233104584;-6.6214027102172439143 -3.6900764901947260554 0.47589360887586984461 -3.5022717953117914469 0.34954687743758744434 -0.56751194359991685712 1.4377928260260026683 2.2470784160440637756 -1.9150200272281778791 0.81046165372992484688 1.0606623900338323363 -0.65844477340681628608 -1.5216950521773573435 -2.0757687944210680975 1.2576775415144567649 3.1487899030024117941 2.7810039263235997176 -2.704542467989440091 1.2811668816216592592 -0.30864856875645735323;-0.76615107420231276514 0.3955528769543821821 1.5548222974388199447 -0.4054196834118469206 -2.8764416046070295785 -0.56173368008171797872 -1.0993218090279299748 1.4015375463513453091 1.4680629727218204028 1.6297930284245025767 0.94693239143300944605 -1.3123962273185507676 2.6419241865232909738 -0.20692226785563719305 -0.54706220449116815807 1.6076208790292938478 0.99294923693032899337 0.84778827098733222645 0.059172535159384712089 2.4107882033400289679;-3.6481003471094006763 -1.9740660083078627185 0.45947089551163144971 -3.8542613216314647318 -1.8606681348156213218 0.14081954544171998434 1.0048758541066911132 0.73230978322925399659 -3.4877227461397364294 0.3199995406292585054 -1.6060565880351640455 -1.960951093134387202 -0.33057698862146134289 -0.19823822062768292618 0.26486331514321997949 -1.2460293023613049357 -1.3276445928649331929 0.66921084354431215058 -0.28476726856491391127 -1.2623384435899185352];
  
  % Layer 2
  b2 = -0.9211141894201355651;
  LW2_1 = [4.3926608973932212976 8.1592982469172739002 -9.1660337118145083224 -5.1606615798874679868 -8.7940099450927462499];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

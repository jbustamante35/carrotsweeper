function [Y,Xf,Af] = tp46f863f0_e1e0_4cff_b844_31ad41da2144(X,~,~)
%TP46F863F0_E1E0_4CFF_B844_31AD41DA2144 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 02-Sep-2017 18:52:29.
% 
% [Y] = tp46f863f0_e1e0_4cff_b844_31ad41da2144(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-6506.15769134605;-1968.46879957595;-1377.69545894784;-758.119043371399;-1005.44642162531;-629.490616020365;-447.37811863832;-450.686587111716;-682.76547757345;-458.333844314352;-622.812481590515;-432.343869290213;-413.434624609492;-429.961560001116;-373.705895665987;-359.072122656306;-277.037336897485;-301.078315473943;-400.794724948416;-285.384637074684];
  x1_step1_gain = [0.000244911356138662;0.000507837665104201;0.000859080031338268;0.00102992699402406;0.00116476174985821;0.00153608271588201;0.0018649088281987;0.00229564725234536;0.00140550898923535;0.00187872252206336;0.00209870879134677;0.00237421637966938;0.0024968391825788;0.00271795669482114;0.00287765136194793;0.00323536160952172;0.00314965135524202;0.00399550556362208;0.00295376821702625;0.0037505121487596];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [2.2833269969386509324;-1.7386227179441517965;-0.46549281411199694425;1.9750022480728721685;1.4335988438988058746];
  IW1_1 = [-2.2852904518536827361 -0.52456420930573111061 2.8889430429576408166 1.175500835920832321 2.8043463067872842487 2.1484260416248002201 -0.31610863197800176394 -2.1659846000583597991 -0.76600487596886945862 0.60581626209501071578 -1.4812265007976859188 2.8321388557568862865 0.9311900767720767691 3.5848279151692254985 2.1620796483558315515 1.3448697938633822346 -4.3454176552627714614 1.0304633209411162564 -0.92262014159290184345 -0.7995631082359034858;2.1333226970719461058 0.71247185710070359832 1.7588165181655337488 -3.2214851382932541135 1.8063833927215975361 -0.084729601713456240142 -2.0557118993578833432 -1.2623736336976565386 1.7212891177726845626 1.0053336383318529634 -1.7911345416017214749 1.0938154905062882349 -0.52519203084112275892 0.9876886637840702754 0.0063000464618082514801 0.047682747019665808197 1.2294963095272961606 -1.7857963901788105332 -0.42493824511544853184 -0.8227968932720415296;-0.73676916851023610544 -3.0735404658086573626 -1.2880434882674514085 2.8153355676866094193 -0.73408490965638617531 2.38093108470425463 -0.75461294118761523819 -0.81763414856352023552 -2.4985218325322131605 -0.730015947888220329 0.48036443466797434931 0.26668117340614871935 1.4848714083839951172 1.441201353554632858 0.68085731346012845489 -2.320605904801765984 0.67288704160097401186 0.75926565046002347792 4.0978092295119941113 -0.38249291567077103871;2.0495756406451990372 -1.6748504086821709436 -1.0571286223767808465 3.2820584822275802317 -2.9763624153089165425 0.24097460231898717997 1.9734119717848244147 3.0277011494926906465 6.8612272443313733206 1.7416042641664846169 0.27015144145649716556 -0.89626601952171525145 1.7715148552172284013 0.61226086880514563049 -0.73263624552600448148 -1.087528729825154139 0.77887919485308643175 -1.0552065054347825601 -1.95301042217776466 0.92983139959986171874;1.7481743305759527285 3.9570148689142703446 0.197335745765519599 0.26379458268564909273 1.5985721847737426327 0.27058471196768774103 0.37421940921534907476 2.0042466187085907769 2.7356245485475292334 0.6987859099760611592 -1.6175077880004713471 1.9305809689894954939 -0.57705416785556906678 -1.8390362791579510926 1.129622141232921706 -1.468987283298992752 -0.80825144103729595901 1.9620015977710096866 0.13910454102831376622 0.56669689527967681553];
  
  % Layer 2
  b2 = 0.018785051304692632762;
  LW2_1 = [6.4382444425572007418 3.7177654880151833616 5.8568915258804157276 6.3750447493538269228 -7.2380094573917066469];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

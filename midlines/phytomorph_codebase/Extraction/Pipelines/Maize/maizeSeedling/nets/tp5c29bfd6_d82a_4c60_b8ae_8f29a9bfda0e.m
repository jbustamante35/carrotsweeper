function [Y,Xf,Af] = tp5c29bfd6_d82a_4c60_b8ae_8f29a9bfda0e(X,~,~)
%TP5C29BFD6_D82A_4C60_B8AE_8F29A9BFDA0E neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 29-Aug-2017 20:41:40.
% 
% [Y] = tp5c29bfd6_d82a_4c60_b8ae_8f29a9bfda0e(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442496;-5454.91534726369;-869.204807020143;-780.471896742375;-460.20555521635;-234.310604878461;-540.291178237133;-572.14271553379;-620.900292310247;-263.80049063085;-210.820779921779;-258.183122033521;-343.803894881911;-190.320782432689;-193.663740648593;-194.470619647335;-373.104709120367;-213.719449945762;-258.8588473988;-135.174215342509];
  x1_step1_gain = [0.000342540442445781;0.00027748074658588;0.00080601324116702;0.00156677380853904;0.00168393926281428;0.00269046527889069;0.00198084992045411;0.00236361816544284;0.00245784730269614;0.00195235680232595;0.00282106579415897;0.00424658079482962;0.0031726176926076;0.005554586874619;0.00429724736478089;0.00484270636687467;0.00333931608099041;0.00598913897545082;0.00384783002604044;0.00642488839732231];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.6535354393181158628;2.1528143176002840775;0.029406768148166183979;-0.66345692759872187949;-0.31640516930696072073;-1.8323147097496250701;-1.1810355337543740895;-0.021393178278189935171;-1.4478820302282333632;1.6965190506647265245];
  IW1_1 = [-0.47191836101235012935 0.22891868482815469488 0.58378346476646414409 0.12175574918030514227 0.23593060233942339532 0.4339804280174815454 0.32486024896527732064 0.27441865981596785806 -0.078584751173006617275 -0.49009010663537372343 -0.29964308478445839112 0.48039171034929656345 0.62065989053730608038 0.433446037763810188 -0.044211825597108442287 -0.0032372732593938732815 -0.26741826071380075946 -0.054381860009030169589 -0.017967929984905456342 -0.31851916073909619653;-0.68676853009083627111 1.1869020961933660629 -0.26608066008335384822 0.040310949643075029425 -0.11483698628777093409 -0.098917772798641528942 0.071119433390305061837 -0.12974104079400008982 0.40243474938364154347 -0.25295797811539583178 -0.4362983382698835122 0.0040653703703104710973 0.49284037998286306381 0.42147639150293320087 0.30796792506363662723 0.061784446478167311112 -0.31932719411153703826 -0.088412550586481619685 -0.189220676522050546 -0.057815490127059450398;-0.91990628576175692555 -3.8312512217033147799 0.38454563262970281601 -0.40310072811534863879 -1.0706878858870849669 -0.46163123218980134377 0.36359895949953818794 0.83660908294467983826 0.53592942127796183716 -0.48338050078976740886 -0.79336078092442496867 0.13179740406193346525 -0.23544139158018773106 -0.33549633351334523512 0.72026272803534252542 0.75936355408188482841 -0.17949208249736436915 -0.41245362070573432511 0.80072969767067780911 0.32621426773152406575;0.22685481105853577688 -0.084644284759632620885 -0.53814278314416241766 -0.59522935624496020601 -0.15453214143058555119 -0.35497352774636548034 -0.5209456147104608581 -0.10542623042449930648 -0.18417752235858483867 0.55963258280544492251 0.46273619340523536314 -0.54335643154667556676 0.0928317858178176053 0.017488157120290608038 0.063876633461572018824 0.49130375453752000992 0.035350835684999158681 0.092332269264771282824 0.31212332576982398935 -0.36950508072967985784;1.5163418084191451207 1.3436957633584618588 -0.084931165820225917873 -0.50612022969221948099 0.82644479524075042942 -0.51528204335331140307 -0.37604597825982039039 -0.41369554762154103766 0.57080133502252838884 -0.35154052190068130201 0.64399747487831882076 -0.73712677213370392248 -0.21554652830376835881 0.56825526189767738838 0.11608586745040468113 -0.30780901138982685872 0.46079435794240641844 -0.43753122139928096734 -0.28746685384727704848 -0.54508035393045928263;-1.7848508153696436285 -3.4915286207021516418 -0.6813444904821294168 0.51072339455909709915 -1.0970423813167364813 -0.30018798723867140543 -0.029110780019470101909 1.5871230619299490083 1.0355655653317918929 -0.62478419507908544706 -1.2065755710614300966 0.17201851794833472598 -0.56594189828357732708 0.36840999943404229011 1.1137554008151466789 -0.48827165973986258463 -1.087140643935059936 0.26497493572766717129 1.9479394952245412398 -0.28833612507421851889;-1.9299755426409701542 -1.555951043719245197 0.015099655863503516975 1.3533109331484367566 -1.5668302289456321752 0.50961065029190910636 0.22239395318699400894 -0.057102535342723970135 0.99291128856632748789 -0.52719892206434082471 -0.045815115204933795634 -0.97444413194668988432 -0.027578907107585041297 0.63367063554258162839 -0.247641294293455827 0.35433490066474643276 0.53177039355040067736 -0.47677319864656148019 0.43725941173198812351 0.10481783268668443121;-0.023457735747916815677 -1.1073907233644291193 0.71707422205513837721 0.23634925289079786181 0.49450990791034865612 -0.73179674551870477206 0.4708474077434627314 -0.69787106898035833336 -0.77967691073043132732 0.7607547260252434107 -0.16278560854366097566 -0.39743628669501546158 0.48260643120894392011 -0.046522150746120198572 0.7911159462228911643 0.25354217843432802493 0.29859647662363564269 0.73543263424815497054 -0.87807931530063598746 -0.1670558575779407251;-0.58039441138615921467 0.099094979625721599237 0.31808284392084962278 -0.028806184665235268216 0.30903490600911781572 0.47537328955999369473 -0.41703953130289850293 0.2642327354762865621 -0.67817365012066521679 0.17449106229529109946 0.08073462121409583081 0.11959680987904731941 -0.14073295618627112979 -0.43796010795647882796 0.072333309364819603493 -0.46335571613055082096 -0.58053713132720274892 0.17449409304800722609 -0.052033145260616503469 -0.34403825350229272351;-0.02556755059828179355 0.39781383262999892025 0.56821900094626254241 -0.4848529938462575184 0.25888978037170523594 -0.59206929176567801854 0.44110369462134485508 -0.35669931806438870403 0.087221169099553699788 -0.30511173015021719745 0.011452527422647519953 0.27899377843085743089 0.49494285195530429711 -0.41233761652709155499 0.15146285809556847557 0.26843885901832631458 -0.05526440959964563221 0.21066031533341192383 -0.074309694575955556606 -0.5239099497204581235];
  
  % Layer 2
  b2 = -0.47798569901603887855;
  LW2_1 = [-1.0850345978198052688 0.17426489445737594619 -3.3407226020647078357 0.24170686742179062212 1.2744342303420364004 -4.2587193349614205218 -1.593232978506681663 -1.5906479151254686588 -0.27501361098635768165 -0.71691359087235884129];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

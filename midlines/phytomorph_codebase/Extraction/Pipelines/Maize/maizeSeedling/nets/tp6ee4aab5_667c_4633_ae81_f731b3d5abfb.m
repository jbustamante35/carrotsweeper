function [Y,Xf,Af] = tp6ee4aab5_667c_4633_ae81_f731b3d5abfb(X,~,~)
%TP6EE4AAB5_667C_4633_AE81_F731B3D5ABFB neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 31-Aug-2017 18:52:46.
% 
% [Y] = tp6ee4aab5_667c_4633_ae81_f731b3d5abfb(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923585;-1028.71862143181;-451.710971542893;-692.538815519993;-441.04379323221;-783.667639824725;-450.026271289922;-656.555828069291;-380.160028036832;-183.58947139103;-268.743398235219;-384.146123020648;-242.574763141828;-233.266353450966;-248.555985162466;-296.419908591326;-275.82100391888;-162.786711803972;-155.930294068988];
  x1_step1_gain = [0.000192953812201724;0.000635170113819407;0.0010737117105794;0.000992967389065705;0.00140247416929524;0.00179426803546528;0.00152094087103249;0.00262475201653716;0.00199415494766506;0.00251075910029929;0.00454433874041195;0.00378662000738744;0.00302237737948996;0.00448879604138593;0.00366080733460318;0.00363057230533598;0.00381924645547047;0.0042753758227442;0.0059212055178142;0.00602422138644207];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.408576795905589929;-1.1519308125067937443;1.2199567538873681283;0.098923784669090505939;-1.1061063894837448451;-1.2279106695863530874;-1.4596814312862735896;0.8487343724013223234;-0.66059019132316654233;0.11887972379227410014];
  IW1_1 = [-0.20092561919360527045 1.4788285666129272755 0.79147774853971164521 -0.27482383830141393632 -0.23354814782735205947 -0.12246218798971367225 1.3756943470842792898 1.3255381094408826836 0.051663789799579036555 0.38202535792405328818 1.9228365351930101212 0.33653487282181859808 -0.30891938080584108173 -1.1939973033783459755 0.12610190286928329995 0.34843686509839105758 -0.57065982138981219407 -0.68358044141448792708 -0.054741748478929375121 0.60839503594805577347;-0.9783023274666409197 -2.6472462480272103136 -2.1072029909344696108 -0.69922031848918186903 4.231255292500587295 -1.0210210976229685542 -1.4667860740266256414 1.3212073710856826469 -3.5123678747272673029 0.055148485778088708609 1.9160956306880743139 2.0655868844876894563 -2.3597844401489735944 0.57755416750177523966 -0.34667958013411231954 -1.1176727231307053145 -0.1309328960021272914 -1.1464716482039660761 -1.1639110681077964315 0.21878869840682868553;0.29599507403227570679 -1.8413690171922196814 -0.15250763280483470297 -0.64160509142163257845 -1.8306249690531761765 1.1650911609211362929 -1.1240879004237973593 -0.45747528965327260986 0.81285930100006908994 -0.27822177557185662211 0.53119419024529956896 -0.97844966474547989677 -0.011024384161366206775 0.98119037880310155941 0.18867083195097553161 0.33971664109162813538 -0.30005613199395436697 1.4792926229253231529 -0.40240347327907027841 0.57714595961878767394;3.0528977788963267415 0.39272014155297418903 -2.0188989130555112794 -2.8593100697981790326 3.197547027787650098 0.90723688737387975234 -2.0139889385823206425 0.3869287735624161173 -3.1438970035799536085 -0.36288401709682066576 2.2985674502012902742 2.0721900833527473473 -3.3581820318831887562 -1.1101287626972331513 -0.033293838815408566267 -0.033394269786843455705 0.70445549098716198078 -2.7799922229545193098 0.082509351933514663013 1.042605788328956784;-5.4734579231946556277 -0.050804786762098451403 0.11031755501005995057 -0.15155632680003283674 -0.11209932644812108105 1.2112097637385630389 -0.28940168153403250662 -0.59985345306045645408 -0.74770535343955824015 -0.49033742407382047146 -0.050746859419827927695 -1.0185892911416378759 0.37504121946617041683 -1.6016883117256754954 1.1915168813167795747 -1.5045067139143313284 0.4006080220892752064 1.0728247049899408694 0.31808717639302203084 1.616592628424080802;-0.0025005434398869901512 -2.8040437347829532122 -1.618509947621298295 -3.004126664471316932 1.2468842539076288034 0.65620089617238552826 0.38343209429498653629 0.68154537735556741662 -0.82382770238489499981 -1.0124378913195282159 1.4623500061204128819 1.0888277071682141983 -0.74172334584087551423 -0.69580693753946076807 0.80414164445911606727 -0.84947187239992560936 -0.04587168388136310393 -1.4188147940116386803 -0.066056965740926607 0.30417783547270732525;-0.51652191820540915845 -0.089965780833537345451 0.73751009017429813852 -0.97180369542207523104 -0.44147181550105552006 -0.37998019373169605872 -0.21712203434917878853 0.40324135939601085665 -0.78358475140899819245 -0.64285691967796099178 0.36994848464500817986 0.0027414392775873593772 1.0860802402917482112 -0.21738720572861366942 0.091723461054998858821 0.12186206686481350359 -0.25807088953193907388 -1.2051028359812483437 -0.28392054151120516003 -0.11981621725327298855;0.43549722481542940677 -0.028694892867515538193 -0.18690542150895778084 -0.14660482444863831564 0.099073880845897299707 -0.38903820315760795356 -0.13663105998547556141 -0.096712449828048135947 0.52282646194047299737 -0.53666714921257152593 -0.1672105843593370833 0.68065938690101868147 0.78738893750576610664 -0.63169470126495919082 -0.0088375769527525710467 -0.75547959070753611943 -0.30397410876683128578 0.24300320777057982102 0.35845932695930304845 -0.16620422964911543695;-2.7308562642992715297 -1.6135767770178190972 -0.35146962604209019965 -0.49876245023290960434 0.29626323641805424325 0.44079435038146635994 -0.37132676219987154065 0.046715158366104757304 -0.43341261017310778181 0.52760378959793463594 -0.15579110783615332525 0.5201048827698432353 -0.43246403999043486754 -0.7769235823242675032 -0.4145011067665664295 -0.3175539040561892179 -0.10515688869661775351 -0.66777832266747094714 0.20252953585900962397 0.99835057396657511664;1.0739549819042557566 -1.8839040556113333391 0.19795468370239654998 0.007495984108705427279 0.14441511200154166783 0.11646294970004771041 -1.0410804483464246584 -0.20792086480121627079 1.5075522484327805728 -0.78307403604261094365 -0.54958321390789721672 0.74128695533631372427 -0.41840648594802043458 -0.19431194853781047494 0.57452623514926592918 0.17446176448925146407 -0.35877767717157371674 -0.0063983117175761064499 0.23570315599066560264 -0.52800534285729650019];
  
  % Layer 2
  b2 = -3.1775943838727767066;
  LW2_1 = [-3.0201710620079809111 -5.4440206720176318456 -4.0334600787363896757 -5.7942058455527707395 -5.2265708463428719455 5.78756307707958495 3.4428326975774856678 -2.1004732614920227363 -1.6240015473979774185 -2.7530821232494502304];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

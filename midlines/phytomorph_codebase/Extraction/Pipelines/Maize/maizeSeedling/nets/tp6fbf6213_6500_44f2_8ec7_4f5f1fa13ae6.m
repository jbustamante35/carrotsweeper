function [Y,Xf,Af] = tp6fbf6213_6500_44f2_8ec7_4f5f1fa13ae6(X,~,~)
%TP6FBF6213_6500_44F2_8EC7_4F5F1FA13AE6 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Sep-2017 19:20:08.
% 
% [Y] = tp6fbf6213_6500_44f2_8ec7_4f5f1fa13ae6(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-5454.91534726369;-869.204807020145;-780.471896742374;-460.205555216351;-234.310604878463;-540.291178237133;-572.14271553379;-620.900292310254;-760.602424664796;-210.820779921781;-212.78401520665;-286.590370604325;-169.741999038737;-193.663740648595;-194.470619647335;-225.82032567502;-213.719449945759;-258.858847398803;-135.174215342505];
  x1_step1_gain = [0.00034254044244578;0.00027748074658588;0.000806013241167017;0.00156677380853905;0.00168393926281428;0.00269046527889068;0.00198084992045411;0.00236361816544284;0.00245784730269612;0.00195235680232596;0.00282106579415898;0.00424658079482951;0.00317261769260758;0.005554586874619;0.00429724736478089;0.00484270636687463;0.00333931608099048;0.0059891389754509;0.00384783002604039;0.00642488839732244];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.4408667720010666091;1.2108822391720093226;-2.6567413170312295101;-0.96829369379236507331;5.6009639272722653303];
  IW1_1 = [-2.9079339539606596787 -0.48668988407301816412 -1.2233675718610697025 -0.13039089148913005078 1.8904357144597259133 2.0697112195351419217 0.97471618412673255438 0.81189224834993956037 0.37370462451151548189 -0.80263671652819801317 0.075951805711510347874 -0.44631881571124371044 0.27343942116533909159 0.16215700617965042585 -1.1201499161433985385 0.91709006373207369034 0.84540532098105936054 -1.279651580778714548 -2.0479307661204440016 0.08491198045721753962;0.58452908750081955525 -1.2000882505018397595 0.60420500938351273668 2.5917065985078910906 -0.037003947332784933866 -2.6550939727815587865 0.84619135279245805137 1.1658452184975727217 -1.9021964915994835632 -1.4410247740519241955 -3.07136995242009192 -1.5687940843799788038 0.27651078475758933406 -0.75622499718690450177 -1.1730396807390213176 0.50733076548092637115 0.38244824921520270689 0.34654561652849652509 -3.0726213253478098508 0.51201890857954091008;-0.4197769234154304363 -3.3233245396264297078 -0.2000560215049832502 -0.051997830090422116067 -2.662779426067112265 -0.15511012166462156969 -0.78949782477703678296 2.912801895332839397 1.7101522861477143067 4.0505396963216799833 -0.96356559592226720401 0.58784137389580071176 0.85924472014712216517 0.8866066445443923083 0.76887186215289260449 1.6602075775216815767 2.3158089048511434349 0.6600904111362265736 4.4934469907994190052 -0.064821588333959068162;0.83982962690565354791 3.0467106199747733264 -1.586617822734856631 -2.4021994434761406723 -0.39861195365963886239 2.3387200491896682486 -0.25334677247646048004 2.1178897566603436253 1.0448691430808052516 0.038237530709506667437 -1.4640632816846435027 0.79803938462495715989 -0.55542701251671622309 -0.566583840672871486 -2.0250106868059085663 1.943774047377106573 0.31695655296134406242 0.35714243637329839975 0.77066342663097664456 0.48012392694876637744;4.1031231023980136996 2.60518489439327805 0.89474197527227339322 2.2659570666573776165 2.5781831285840826062 0.56557356064444674892 0.39683678969493857425 -2.4453303504968668669 -2.5390127856915309934 -1.1309609872686094967 3.3391701245456291147 0.31310295203273946774 -1.3947685942008367643 -0.050281616034617372668 -2.105739517253483406 0.11043503394491138714 -0.79280174267974379276 0.16874061836231760148 -2.0094565241705577563 1.1842869646428280106];
  
  % Layer 2
  b2 = 1.1423244111926396105;
  LW2_1 = [-3.189633026752885403 -4.9889133311545945659 -5.1899788725001441136 7.1921538178224100335 5.2248975087869462541];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

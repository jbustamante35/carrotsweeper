function [Y,Xf,Af] = tp7404896f_05c1_4d28_97c4_32adfeaa6d27(X,~,~)
%TP7404896F_05C1_4D28_97C4_32ADFEAA6D27 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 01-Sep-2017 01:09:29.
% 
% [Y] = tp7404896f_05c1_4d28_97c4_32adfeaa6d27(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923585;-1028.71862143181;-451.710971542896;-692.538815519994;-441.043793232209;-783.667639824724;-450.026271289927;-656.555828069289;-416.411813428009;-256.518565057566;-259.432124024274;-384.14612302067;-202.979007080806;-233.266353450968;-248.555985162477;-227.243600249572;-191.974128700877;-162.786711803944;-155.930294068939];
  x1_step1_gain = [0.000192953812201724;0.000635170113819406;0.0010737117105794;0.000992967389065705;0.00140247416929523;0.00179426803546528;0.00152094087103249;0.00262475201653715;0.00199415494766507;0.00251075910029926;0.0045443387404118;0.00378662000738719;0.00302237737948964;0.00448879604138494;0.0036608073346037;0.003630572305336;0.00381924645547069;0.00427537582274426;0.0059212055178141;0.00602422138644352];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-4.1474764602293596738;-2.2329250582999269348;-5.5161034498669287984;-0.27706078978244447208;2.6748279684204239182;4.5286355301465519574;-1.5696545882466841348;2.4010689848750979003;2.393351993581195547;1.7848722263267771115];
  IW1_1 = [0.16087026079711380655 -1.9567872108594304148 -0.33824374057872585997 -1.1298619623818400015 -1.447671990252950236 -1.0671700669534720518 -2.0556364348539180043 1.6983212184069993445 2.8882276775920510126 1.4211558829499277845 2.7854886617970615603 2.6553258938672534839 4.1146804441413449283 -0.10029411248161722303 -0.97751575504332299804 0.34086690951887693712 -0.72256462337155480391 0.73297397992536117428 -1.5442276081671710841 -1.4192452631782641603;0.45012016821238215458 -2.0005634444830766583 -0.63083337956571328142 -1.3493669470653708586 -0.34462029179740488738 -0.73509319191735100762 -1.0483717535312149227 1.6070808922000165975 -0.3819939159643537252 -0.25589520570550949863 0.45532481648098394045 0.48060289025866986812 1.1412246070508733631 -0.55054124518550440204 -0.72372327283854931412 -0.91587351977171183037 0.10459284118231559901 -0.23951283239550774651 -0.68336839932422566157 -0.36642962709543425159;-4.6923081333510445745 -2.766387488188744026 5.4781864729219336141 0.30542591053896894771 -6.1408666491593342229 -1.2359649745796532638 -0.42130803316595788477 -1.0711212372635925405 10.496734494251306558 4.7667004940943824565 8.3280698559135721837 3.7323567232478986888 6.7700039494472763479 1.2952282397084013965 0.26264484711461799638 0.4624172214954148652 0.31686706953801485609 0.47881411982226917967 -1.2164713819011456764 -0.8582182588948777946;-0.80282016585966797795 -0.17731496308144115148 0.40750131381231957661 -0.060332465661850076533 -0.48273005703498717001 0.51735490336141420897 -0.72186780868589406346 0.73720563589771814783 0.17642205480401615403 0.18018404892830561237 0.0110428361373691164 -0.37611793514518948589 0.51598099775480077422 0.54531687115340166105 0.26002211898090837883 -0.47817259308213450053 -0.35338816012010421108 -0.13133341681726740102 -0.42049839764521107499 -0.21378841893255370876;1.9452280065392615338 1.5671516045734810163 -1.2484990857389228758 -0.30288378278511207675 2.1766855967662004367 1.038560964848642465 1.3491472170849321266 -0.65367825774693344432 -2.2602420867557468931 -1.137192089739142542 -1.8528651220608653993 -0.61150642783432429539 -2.1916750222214096411 0.39671536715198579826 0.72303134853003803162 1.2170953247972582378 0.26513577104788449423 -0.37295980493031127834 0.17723669963319391152 1.1050361535916544131;-1.8132514088463576041 5.5852134332006402317 2.0923627538524187663 6.331198149709014622 -4.65394936933810488 -0.19507758006488715163 3.3023727119640975403 -2.5122113906882441725 0.1725213825284015734 1.4098297286979455389 2.0345521038295300009 -0.3745156493308506862 -0.06151175557684583628 2.1297342940004821976 2.9296045194393460775 1.0230153937989743262 -1.9428859294936229318 -0.24857508291933433364 0.12564997870007843517 -0.63864380926173991426;-0.015081105769511920361 0.26528856267635519961 0.088339658677884055904 0.62847718496253424103 0.15967609727108941775 0.66666498195013035311 0.16777877320104500614 -0.40687074932082617496 0.037633836401036561969 0.13215504591735161011 -0.79368356136921824895 0.29227450825227307973 -0.88077334721942091011 0.2469016969161625108 0.32266382830331929998 -0.14518688981031585561 -0.097786842949439983785 0.083298395444985906533 0.11575520491431391668 -0.15556965011750398253;0.0051316066753652510649 0.080964674065515551682 0.55337835129494916675 -0.64657833000852804606 -0.22659246162053581219 0.028305103644444981614 0.07455835062354171372 0.0087314959231670988965 0.089359909305569140692 -0.24078661463049549907 0.73748834135618956953 -0.35720156878470965545 -0.19861768181763980734 0.31417622837513098366 -0.09694876228791672601 -0.038529876353818721946 -0.049347330762647835523 -0.10411615294986892311 -0.45480110889317854062 -0.065723775254462879492;0.22623480339861629096 -0.33943217834837091651 0.20898711555436794152 -0.72418261833796482296 -0.46253928680465322687 -0.048115372444142261166 0.56254270881563139817 0.36846322733516079229 0.58045563769005159571 -0.097904587830795017367 0.35381523569356493342 0.10487892443135031495 -0.35182144303079099235 0.11173337421343457199 -0.033077943406905362111 0.50331986374144599417 -0.33491033717533458258 0.10955875509913207133 -0.19647444463894822575 -0.27721068393183051493;-1.4387481755493345403 2.7531885089188201654 0.10912628431304788323 -0.077845947793865888364 -0.2353141163881304343 0.0030428259010793975992 2.1048442664384201528 -2.1826009952672080772 -0.75967999198677782502 -0.74476014694348791068 -0.64559817386419271479 -0.16455434964108903162 -1.8730884294617902164 0.097803725186533463365 0.027147646752020020144 0.39385340050410228008 -1.3170585797111473703 -1.0064697591520854747 1.0208502762281599363 0.16512587752956389697];
  
  % Layer 2
  b2 = -5.0490873861115703747;
  LW2_1 = [5.9861916381585462688 4.7015613500642006173 16.825853348821716793 0.31861175478191949839 -3.9340406688862152862 -16.285152762864786524 2.5276408185782850424 -4.7398923418732641366 -6.3744328811687065439 -3.7439234518558182074];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

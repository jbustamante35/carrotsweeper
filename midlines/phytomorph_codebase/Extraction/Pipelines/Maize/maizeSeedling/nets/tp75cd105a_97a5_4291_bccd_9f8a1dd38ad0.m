function [Y,Xf,Af] = tp75cd105a_97a5_4291_bccd_9f8a1dd38ad0(X,~,~)
%TP75CD105A_97A5_4291_BCCD_9F8A1DD38AD0 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Sep-2017 12:28:02.
% 
% [Y] = tp75cd105a_97a5_4291_bccd_9f8a1dd38ad0(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-2001.76879548539;-1846.28602050405;-1096.59977942709;-1127.27896682562;-718.635970677914;-534.736579087551;-636.877630731668;-474.328050496926;-408.75677360525;-607.267828431686;-597.158358369126;-252.73701806495;-357.743301501268;-305.701917871581;-262.500890231169;-420.955237007935;-168.878309979167;-265.923075543781;-279.306010526067;-382.085749121019];
  x1_step1_gain = [0.000250772026915415;0.000457175383291266;0.000795694570296747;0.000975455655635303;0.00136867839470429;0.00177765334299386;0.00147664952758212;0.00196526984478521;0.00211681540578917;0.00191395299404994;0.00213803411115004;0.00313745816598829;0.00239499394158854;0.00262802245354375;0.00340299377226968;0.00307580218448469;0.00420342200465333;0.00353937526659747;0.00305696135696254;0.00320422591704695];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.3205602241590677082;-2.8634476092514402623;1.9975836650879175149;-0.49297068453714626424;-0.12303254957982666384];
  IW1_1 = [-0.59342330778034579897 3.0156560645704524326 1.2692415177543541205 -0.17697565642816107112 0.80324005438596601802 -0.4312098171163198379 -0.056151794379970580706 0.721243588606537811 0.94885050644978330414 -2.8827933809127501696 -3.1413501336967084576 3.1346451179028438361 1.0051327570061920902 1.7215609162992651093 -1.0775064595675234447 -1.8714906900553698321 -0.23895654642436725545 2.2635909579945088232 -6.0230085181793509008 6.4506180811668389907;1.5241682976092925106 -1.9381887899652379126 0.35791058098982747593 -2.120644017246413604 2.0890642031847046489 -0.70129782635734549956 -2.131097713860282461 0.70422787887022675335 -1.1338861471820447235 1.8927744041503755668 3.8757663800655395292 0.11952810270757933953 -0.73987933953556905831 -2.6448291092859492757 -2.2556400745546798525 1.4444712070716809738 1.3763911609364034572 2.0696805661860673275 0.39308831850182213152 0.74110514826938100885;4.1168337279908300275 5.7436665008588585479 -3.5952658836866908665 0.20497538745221538514 -0.43989144448178302271 0.26010807351891523931 2.495357029994987208 2.7075136422330317032 -1.8414071632737956108 -2.1496304189478210311 5.8879270439711026697 1.6030212184570249434 7.632012594233444247 -0.56764933895271985076 1.4800460599560476549 4.2640029169933590936 1.558823160496436655 -1.3461659159364587346 2.0578028222897675192 0.95639414813471312904;-2.0816750074368934875 1.9115976239581042861 -1.3222156010220065259 0.44086266266307455597 0.93411357666705918668 -0.14878023642456283948 -2.5206332243666556003 2.0216453551258179999 -2.561183080591572736 0.20705345224416324412 0.69968251485391108613 -0.70239761400989286777 -4.2659106008395877296 -2.8453526395927490888 -2.3826109833993394105 3.1595990922737344775 1.9301548399463595018 -0.70678708730484562928 4.6815093766294548772 -3.8363603939011263755;-1.8621548314275331304 4.4518845029801576985 0.55646495246166749471 3.3873086166684860387 0.76050929849705029007 -0.040630651533747584592 3.8464940676445720236 -0.099848827286255784075 2.0551839990737743591 -1.495173283274592313 3.4466692792092965547 -1.7926937456338896126 15.597183107064344298 3.6116992748954612757 0.42427731578909361199 -2.8788699127714330039 0.81722707381718362463 -1.4993532667412738935 0.43238150912834127926 -2.8175691664208524223];
  
  % Layer 2
  b2 = -3.7282141541339215429;
  LW2_1 = [-5.4858085409664312238 7.4205981415014079516 -3.1865426825469223004 -4.518320914528221266 -7.7843038084283877609];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

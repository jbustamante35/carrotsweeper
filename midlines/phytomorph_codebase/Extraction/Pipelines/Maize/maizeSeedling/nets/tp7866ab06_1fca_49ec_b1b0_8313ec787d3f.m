function [Y,Xf,Af] = tp7866ab06_1fca_49ec_b1b0_8313ec787d3f(X,~,~)
%TP7866AB06_1FCA_49EC_B1B0_8313EC787D3F neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 30-Aug-2017 10:38:05.
% 
% [Y] = tp7866ab06_1fca_49ec_b1b0_8313ec787d3f(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923584;-1028.71862143182;-451.710971542893;-692.538815520001;-441.043793232209;-783.667639824727;-450.026271289934;-346.375264292297;-416.411813428019;-256.518565057523;-268.74339823518;-384.146123020689;-202.979007080781;-233.26635345097;-248.555985162485;-296.419908591273;-191.974128700851;-174.982344511223;-176.062817024258];
  x1_step1_gain = [0.000192953812201724;0.000635170113819407;0.0010737117105794;0.000992967389065706;0.00140247416929522;0.00179426803546528;0.00152094087103249;0.00262475201653713;0.00199415494766508;0.00251075910029923;0.00454433874041219;0.00378662000738784;0.0030223773794899;0.00448879604138612;0.00366080733460317;0.0036305723053367;0.00381924645546787;0.00427537582274506;0.00592120551781349;0.00602422138644382];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.4092453155555157984;-0.20729092465033951975;2.4666328611497663204;2.0908265610808176582;3.3724323817792050129;1.9340533425318469085;1.6537838764094101585;3.5201640704138190685;-0.039075040279274435295;2.1808871131826466083];
  IW1_1 = [-0.51647268712112914812 0.11363470654634283408 0.19808029195482704243 0.94406695282279406989 0.0019835108798231144978 0.59583601240807060329 0.26425817922109973157 0.095312792688528852336 0.61980933375651248163 0.29176951116806199016 -0.8403328351910118732 -0.059255323141429068479 -0.62334026534581277179 -0.095450826402509084123 0.29084093840155256228 -0.21494769700764002063 0.45498181671745996368 0.34423565768219177574 0.57749300200536368699 -0.42004628680647038141;-4.0789210725040323524 1.2964211459873942189 3.5497184413006719339 0.89146872489281214769 -3.0169215220722001014 -0.7705858836913769272 1.1589353272587057386 -1.2509733800649569524 -4.0273269995962639456 1.5508904359741160217 2.7872528837852459382 -0.86432532448232346489 2.1294044866493582191 -1.3266211931811864311 -0.36679049155987669684 0.39442530756783983348 -0.27558315849049158652 -0.84938105306580657938 -0.17911601628918652485 1.1508982784239256691;-0.5434175392705649088 1.2743677691941495134 0.30055649519084942645 0.21862137995515598665 -0.34248019907964161179 0.79637953152067675333 0.86227496598035191511 0.30892621913257473087 0.70539021299620974226 -0.69308239821642303458 -0.97912881025533571311 0.16725663702215928796 -0.21466011931216991138 -0.33058726329769627661 0.23206961138969869896 0.23181464759985873081 0.38460834723346709607 -0.17339757975762040698 0.31640455859328509014 -0.0019933812902559657626;-2.4467358128725948951 3.6101544742102791297 1.762792511362667458 2.7445423361240215421 -2.3453529032340001415 -0.82669160729466872883 0.20905802625444952492 -1.2124754682079450507 -1.3649995711781384156 1.2545333154052578095 -0.0029595092495362904268 0.018469756747553765786 -0.7161502499296483748 0.30215419919274344451 0.73297614938615784919 -0.40526699629322909813 1.1502347756692996583 -0.91656613308602219448 0.039212320053387830776 0.38009211762366501564;-1.2968692418639353736 2.7018838498852879582 -0.014197840818316662462 1.3963741889887171244 0.46559513439668920309 0.43665917358244732416 0.68435283113160216839 -0.58483201344692636869 0.99656158825057294948 -0.1650621805629521599 0.08650926300387162815 0.19749368140926670812 -0.88175444155205418006 0.17622174537139165262 0.93348207383923509362 -0.30088091703554192824 0.49697101307893842836 -1.3513763529743154646 -0.35991832966838555041 -0.34818708541666548717;4.0339500187650214613 0.7210749999332008997 -2.3649280436541424422 0.85129664569936958074 2.0975374989267852044 1.0522574065069474347 -0.17540902743135328157 -0.64432186690887771618 2.2610516592548961512 -2.5137834879271330202 -2.979577050042316877 1.4367563316283789021 -4.3790187311877444287 -0.36276091208488009388 0.63313758326610092286 0.3596055257217661838 0.28105464402454438666 -0.68933504088519026443 0.34557907136397780778 -0.49872382122746977684;-0.80101135985470295342 0.90371056525821968908 0.62468473227744203413 0.59075348215793166418 0.78466052133219887921 -0.12287046581846498838 0.95160604792844116773 -0.61330501280404470243 1.3551218672468889892 -0.24708480699072193909 -1.4973714380372906696 1.559568956330793732 -1.3839595347938937753 0.35562004103599365035 0.64799988130507624184 -0.49406101178995476264 0.079373678746600076495 -0.8518892545210683398 -0.80501841574628740794 0.24029500848983731398;0.53650468006928675457 0.8207696487078651737 -0.14195547826459836704 0.12997031200416839236 -0.40928016168327063795 0.96043739563584906715 1.0813682133548483399 -0.078412898656400609188 1.0828978739166239542 -0.88871190111724518434 -0.79886339244975212992 0.68365111270570910751 -0.89953603741035792485 0.16916623814209108545 0.66013703184288874404 -0.15134668545619556213 0.74068705720143723781 -1.504530792202261047 0.17274050055067088905 -0.11650409269507085164;2.2548684159973158003 -4.51886485380766878 -2.2771183032634341181 -2.9241217796184404421 2.2927956454205840053 0.15919883289222377942 -0.50258503460099568372 0.98134059583976784857 1.6850698100664993628 -0.79097960055154747927 -0.76124508305860605351 -0.45147128589726909231 0.28595636857535289277 -0.27596552960325476667 -0.83963673971802510465 0.22815746102532666328 -1.0455294182077385923 1.5971841347772022246 -0.47207208296240815715 -0.73215200818879866418;0.29719797959481092375 -0.48708230552736037078 0.2335369011888831503 -0.19543879754006637794 -0.63020062170807622515 -0.41297094439977827252 0.47386291290161614009 0.46819319376479157091 0.20163624859144632651 -0.018506625466466315733 0.069363043592100395718 -0.37219533371848995129 -0.15876313387499241259 -0.04426482666235644764 -0.20158200202292977932 0.39444626165254847994 0.26010069110647676682 0.1424072692436683385 -0.30563865856251343223 -0.40321861958374111135];
  
  % Layer 2
  b2 = -2.9807447828712088089;
  LW2_1 = [-2.547042016692121269 7.8064786186906403032 -2.8737181455563121091 -5.1735665277491973413 -3.6293391121396192389 -5.5357976595230145023 -1.999524136575298483 -3.3428555922599385575 6.4078322704730217296 -3.4026245836329103156];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

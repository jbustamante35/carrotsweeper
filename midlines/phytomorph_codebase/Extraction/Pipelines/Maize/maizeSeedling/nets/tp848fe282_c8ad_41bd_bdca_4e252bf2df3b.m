function [Y,Xf,Af] = tp848fe282_c8ad_41bd_bdca_4e252bf2df3b(X,~,~)
%TP848FE282_C8AD_41BD_BDCA_4E252BF2DF3B neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 02-Sep-2017 19:10:13.
% 
% [Y] = tp848fe282_c8ad_41bd_bdca_4e252bf2df3b(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1660.06224852336;-1968.46879957595;-950.376346986718;-1183.76616946853;-711.642931835562;-672.522601966802;-447.378118638319;-420.527401865316;-682.765477573458;-458.333844314375;-622.812481590509;-410.039334332746;-387.578117402338;-429.961560001104;-373.705895665974;-359.072122656304;-277.037336897457;-301.078315473963;-400.794724948392;-285.384637074674];
  x1_step1_gain = [0.000244911356138662;0.000507837665104201;0.000859080031338268;0.00102992699402406;0.00116476174985821;0.00153608271588201;0.00186490882819871;0.00229564725234541;0.00140550898923532;0.00187872252206335;0.0020987087913468;0.0023742163796694;0.00249683918257872;0.00271795669482123;0.00287765136194804;0.00323536160952167;0.00314965135524209;0.00399550556362187;0.00295376821702645;0.00375051214875973];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.2799733929244530017;-1.9287442974439743537;1.1722801571395171649;-1.6457627760362221192;4.7536572580353357864];
  IW1_1 = [0.40952179613382977408 4.865599324655692115 -1.3586319069621655142 4.4597225529614421546 0.84548150899697060989 2.0642584522573002026 0.88047545001738292125 0.84376779729985607048 -5.3931747758753072475 -2.3523779670762210436 2.2949847300871675237 0.65303990144621248959 0.7562461598010545849 4.5631782355274781438 -0.47532946800814562804 5.2998231956644579199 -3.1446133571081142932 2.491444877468095509 -5.7771885781332441567 -0.092856308085891223203;0.26068704552113702855 -5.4800371842501336417 0.0086686330693268708741 -2.4652168340186673134 1.8220159379497589125 -2.0265827915163874273 0.079444263460438521718 2.3865949807671165139 -3.0713177659865649183 1.3990170283294602882 2.2266192541106950564 1.8652721293794660706 -1.459960635785218841 3.0696405849130732335 -0.30096257586310265486 -1.5966486750533617212 0.37919949812609388129 2.34111049920185188 3.164837356968331239 0.24292970911313374605;0.48174313151409431377 3.7403957500610851561 0.47342322033362632672 1.3869925538263736531 -0.21464190166794586134 0.75665635572456657609 0.34344074723500256363 -0.11571277021627998649 1.1842993984651128958 -0.96495888356822767662 -1.7451773365975935537 -1.4346439258668444161 2.9319577850666469487 -4.3748494567634956809 -1.8596730799719303207 1.441383919219476617 0.7232106691504739393 -0.73818612269839412043 0.59916775220653362144 0.84018871602441114188;-1.7944005291086100318 1.6228194261508548379 -2.2405565793190400647 2.9082322463915541988 0.45733989174670858224 -0.34142615164301237662 -2.146364855342376643 4.3805338602350190058 -5.1632823965649405906 -0.50049558221095491461 -2.3565444424408825697 -3.1788743728044388526 1.6666216579829757904 5.6369787304931930905 1.0834640144759024594 0.34731241690759917518 1.5828295126923710434 -0.46102571518950280494 2.1253694087322325679 -2.774040832900010578;-1.7918692677296621518 -4.3490283843745274339 4.9773317024530854269 -4.1312867834568622882 2.8334201021038922796 0.25634578978720512499 1.8065227457796277921 -2.5466443183976616993 6.5564243080804622821 1.8954639943689315373 -2.999736073262083913 2.487189538723329818 -4.147694920239633376 2.3038599609242509381 -0.88565939811263150183 -0.15428083584367216496 1.8128854656205033447 -2.6307773675342422948 -1.5783605941226146463 1.0714781040366836429];
  
  % Layer 2
  b2 = -1.2008155093185062245;
  LW2_1 = [-9.7544982634041321745 9.9723473534911395433 -7.5144534093239414574 10.656761326551409397 11.309218901302182658];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tp87958d5a_2f44_49ee_b6d1_13f2c0db3796(X,~,~)
%TP87958D5A_2F44_49EE_B6D1_13F2C0DB3796 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 01-Sep-2017 00:29:19.
% 
% [Y] = tp87958d5a_2f44_49ee_b6d1_13f2c0db3796(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923585;-1028.71862143181;-451.710971542893;-692.538815520001;-441.043793232209;-783.66763982473;-311.950474474654;-656.555828069283;-380.160028036839;-183.589471391044;-259.43212402423;-277.584610398753;-202.979007080811;-313.061223281933;-302.321350914867;-227.243600249766;-275.821003918779;-162.786711803922;-176.062817024402];
  x1_step1_gain = [0.000192953812201724;0.000635170113819407;0.0010737117105794;0.000992967389065708;0.00140247416929522;0.00179426803546528;0.00152094087103248;0.00262475201653715;0.0019941549476651;0.00251075910029928;0.004544338740412;0.00378662000738761;0.00302237737948973;0.00448879604138532;0.00366080733460351;0.0036305723053366;0.00381924645546944;0.00427537582274548;0.00592120551781299;0.00602422138644292];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.70030461076597927406;2.126602180806875797;-1.4375779870649532111;-4.6194346383886415452;2.1214602427728399547;-1.554095041855425352;0.18608251460273855793;3.7441318596970187826;2.0813121193386909802;1.963670187274444201];
  IW1_1 = [0.28120518294927077108 -0.21423532982452869744 0.99030311040301044478 -0.64090872375178642439 0.66035707960197087552 -0.67925086578916693547 0.28711691681974216284 0.72834070661099370447 -0.012419064579582850955 0.40852161611902892968 0.47592900357007489331 0.097715810777645017993 0.31145553832829919738 0.33657482650157249937 0.11318503467096058257 0.65745621006990695445 0.47565914139487303069 0.70491970339705822823 -0.0011443512674845157055 -0.030102952433994554365;2.0270078949219332287 -1.2496454162935590748 -4.0397129688269997061 -1.6024576686049702978 7.4809285505715665821 -0.90691807564938553554 -4.5833153773575956436 -2.3082007405442666048 -6.3255595236655501878 2.5278722771954251769 6.4364658553392910534 -4.1013725667273419617 7.0691900090864141504 2.1686810950787180907 0.11234754097517270222 -0.98234419153049623574 -1.8747805044946841413 -2.4549459555391366372 -0.53237432164194753437 -0.90481328244763958857;0.17218023455989497905 0.044543307530108849912 -0.52823774707307502574 0.0017429899021296066039 -0.021993813890730740113 -0.32753853199061278012 0.085825107532963074153 -0.26581902534176476971 -0.60793967224355227597 0.32022855216021245406 0.40165778867740359326 -0.01116996910857492864 -0.54234906390301385049 -0.29685588332025392155 -0.36432160346141828633 0.42495851884394092446 -0.10090918943664996255 0.032200029659989741482 -0.3230008246735378008 -0.11626266229919969553;1.6136301604285590017 -3.4364924432638752627 -0.78281109559993633518 -1.2401936633428611856 -0.17686985865360035919 0.54585742291535732651 -2.080919203058147815 -2.0791480916328430872 1.1966303075229978159 -0.64400657936243022039 -1.1204936414621937679 0.50007062902216536937 -1.0038070669039758087 -1.1751310129920409242 0.23933554055173558717 -0.24206271096672402066 -0.1732642547343895556 0.0017467424961100895542 -1.372802499637576501 1.6229973536936042056;0.032027004126373603832 1.7791360206076587414 0.72418275295041012463 0.46885042379912189592 1.0714530059603137868 -0.23172757470932855983 2.1680392350770238963 1.8889991597074859975 -0.34661499156030539659 1.6609720779499714816 2.2506714541058774337 -0.68116894592975729683 3.3780717769505352877 -0.27057940693203974547 0.79036799642872357374 0.53160518763258801656 -0.55019018357169569011 0.1194936412409819404 1.4063761333178252944 -1.3456878855768161785;2.0187581892822596963 -5.4467294404175126132 -1.1058895294594401904 -2.6280341431003795272 3.3788100017307098888 -0.23864885080084002889 -1.3712468470808354404 -1.370635311225147035 -4.6754148779591462315 0.73314420236682009691 0.8940167059641122016 -0.54292694563353094406 0.27406793198262607847 -0.34940559672276377823 1.1000204571171290358 0.090956514474497082712 -1.504639562409878728 -1.2619089142327322151 -0.13800483152078241167 0.68289543218279769032;-0.02567483126324205181 -0.46782822919812722118 0.37999725388992766639 0.25116063651155218217 0.21404471425240742533 -0.50638723958626208344 -0.37257487770867181442 -0.17003713001959269713 0.26568527633062344329 0.46310845170181258457 0.12335896337809357237 0.44954522380689848626 -0.373561608323173866 -0.26824563331117845522 0.18560256137116867836 0.47083499799339767478 0.69543836118474200436 0.38782882048227729221 -0.28610531063047733857 0.3772259311523002423;1.0173611168729548293 2.5504862789944278134 -0.32814993810340531422 0.79711006411902129987 0.64816856820057333621 1.9039065287161776041 1.1817455671495282754 0.68701175505730749382 -2.856163011461461565 1.4092557849198044106 1.6113291190855745239 -0.32738326375923748612 2.1405586546812487292 0.95533293361411886213 -1.0615625602911165082 0.42678964708768307723 -0.23466495548994809051 -0.34913480813023367588 0.17561523766008629854 -1.2741947656834402558;0.29163867405396454169 0.74551243138244194242 0.27727789134577246477 0.58813251220948925546 -0.89974222506490653117 0.42967910687831811778 0.65350484467760161511 0.096262126986054560862 0.36973868791152292301 0.3555823969525538919 0.18261385154832246447 -0.31372147280547907355 1.1632256377047607288 0.73128508095403621514 -0.63463536034677547892 -0.34609898368325053841 0.74047393408810258109 0.30402935000549274891 0.91974350759319467574 -0.28967524039572112304;0.72138404237678643849 -0.89791421446774621895 0.89043744374996491864 0.096634689171660362317 -0.28902618008081093492 0.067734606632982835572 -0.23136570457525590383 0.41195928465969144927 1.3804040861509006 0.33418543286531265935 -0.20962936388205105631 0.061635816252514373514 -0.3392745131147067994 0.14894784316969966742 -0.52989332758491403119 -0.49323149755461753729 0.053871412174807585538 -0.020801306390783171757 -0.096848706673711190684 -0.29904782004063917844];
  
  % Layer 2
  b2 = -3.6080932291539351553;
  LW2_1 = [-0.23796679832579484271 -14.289505416456844245 1.7743639669880115761 6.1864430259727800632 -4.7942650468855401158 10.429951887082140161 -0.15554438967246841941 -4.8879624041630167497 -3.2973435349518300796 -2.5717955509983605467];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

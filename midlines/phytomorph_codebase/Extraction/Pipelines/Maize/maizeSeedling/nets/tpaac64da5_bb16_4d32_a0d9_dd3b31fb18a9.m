function [Y,Xf,Af] = tpaac64da5_bb16_4d32_a0d9_dd3b31fb18a9(X,~,~)
%TPAAC64DA5_BB16_4D32_A0D9_DD3B31FB18A9 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 30-Aug-2017 08:42:01.
% 
% [Y] = tpaac64da5_bb16_4d32_a0d9_dd3b31fb18a9(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442496;-5454.91534726369;-869.204807020142;-780.471896742375;-460.20555521635;-234.31060487846;-540.291178237133;-572.14271553379;-192.819908210792;-263.800490630851;-210.820779921779;-258.183122033531;-286.590370604324;-190.320782432689;-193.663740648593;-194.470619647339;-225.820325675017;-213.71944994576;-260.914631799826;-176.115238468629];
  x1_step1_gain = [0.000342540442445781;0.00027748074658588;0.000806013241167021;0.00156677380853904;0.00168393926281428;0.00269046527889069;0.00198084992045411;0.00236361816544284;0.00245784730269613;0.00195235680232595;0.00282106579415899;0.00424658079482953;0.00317261769260759;0.00555458687461904;0.00429724736478086;0.00484270636687455;0.00333931608099051;0.00598913897545094;0.0038478300260404;0.00642488839732242];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.9782803034582809865;2.0514967670838477609;0.19892610769227006551;1.5525462162298726554;-0.655359747972380835;1.5636191466181104115;2.5178279897087270101;-1.4431557830029126954;-0.45476767533777934238;-1.8031396553955092443];
  IW1_1 = [0.24439424006230706099 -0.77505460706561457584 0.68447926694096183908 -0.54517612658657310654 -0.028273184587779793403 0.48720938653937312379 -0.37026792066325553421 -0.011383270784602533138 1.1384002370258368142 0.90934504143141725585 0.73512178797599636582 0.19571661312563085056 0.25033788320428834728 -0.07569377381724787246 0.6475831171553040333 0.29990019867373518547 0.45236328729633273893 -0.5191484838709045091 0.38998378093257385357 -0.45581481498453479961;0.12046458414489115418 1.4872431450240981565 -0.82240488888389184918 0.10048199222451413559 0.043014841876916752594 -0.16934583327343993853 0.017540046516432233892 0.87862274680936136573 -0.042693495801693799596 -0.077183899674788419842 0.28840836983751277911 -0.52959398353971709472 -0.212508442472550102 0.51343362037940987186 0.13694477052505091286 0.17134302413917273933 -0.55963405762023343826 0.2132161814504447972 -0.11453410434357083614 0.26863522313496390748;0.069888436543050727612 2.9035984996408266134 -1.0574775705010832638 -2.2315532011921392908 -0.60890969883712642297 2.0049332773863679513 -1.3935598659671759592 1.2130373214243843627 -1.3293336578120586999 1.0852769504787105337 0.5262044182969205508 0.21501791668158093396 0.63893930293933054454 -0.30491795603743199194 -2.8826800603329294503 0.55758830483906263176 -0.79721693744767208045 0.12711011686074746851 -0.18592735717508962479 0.14687401083388579304;3.8171274814959841315 4.6958634644283110404 -4.8875473694809334901 -1.8148418600772560083 2.6687927512633589089 -1.9838225408192808885 0.032963177759325924809 0.027118322527404922079 -0.88450375697427607857 -0.7787637213514256862 0.48985216749720594809 0.19725039480829295591 -0.16571557780722001585 0.063629056251655755072 -0.38985471590170434064 0.48554988689188327555 -0.65858675525470178336 0.88969649093532821027 -0.016793361836924539793 -0.23668781105345385041;-1.6778210100202173294 -2.2050776172651707085 1.391175777975724337 1.8858671505822091063 -0.69466354022204224172 0.22744058184569784786 -1.0269377239908352717 -0.43480622527925799625 -0.83831606408970238409 -0.44047955477326561358 -1.0521995618857407084 0.11017501399935696049 0.5587302114125713981 -0.023880751534202271369 -0.63593619371999376977 -0.39602590060251408044 -0.31353575058573979195 0.11074142322617487599 -0.53904576891227040658 0.33587679781173274129;6.8401574556076472078 4.5561302783299959529 -0.97528978932936150059 -1.1783575791951226286 2.8273373407091400011 -1.5490171499057923121 0.72788520597217609698 -1.1458151074959936899 1.16502781995457938 -0.41075079968682781661 0.61452099179185726285 0.27251778414516064641 -0.60247140621116257453 -1.6214353138331754067 -0.218953301560513236 -0.072249416720105680279 0.10187272398511787452 0.28085402911167561824 1.1664224758129910775 0.34595249083040940929;2.9643297075370278471 6.3204907307540327821 -0.10519532639869004498 0.34073343148253781854 2.6889556203653453004 0.88834244598947209592 -0.71707283454495396313 -3.3669059627279205316 2.2201010990200491513 1.275331886076230381 1.1429412199561512775 -1.0430600990755602986 -1.1850857834102443977 0.40404905561566073491 -0.53301441652718706266 -1.0716099016892353113 -1.6932267351621113072 -0.031491713288306043272 1.7460194108096569465 -0.96227912657499625748;0.54248516951457914637 0.25497778528800879583 0.38254909864661418295 -0.35216063639604178181 0.30990619746778713672 -0.41675195239552881299 -0.75041518818591390616 0.26580337643404244874 0.50664702314356291346 -0.58775094879348432908 0.074866961113978683362 -0.34780444587538533741 0.2932508904526303084 0.35786022880906248611 -0.58690240358022216505 -0.60550975626967906695 0.27649789837169186368 -0.41177826917958726405 -0.33629566180846726109 -0.24459353035780934116;4.8326188290230103206 1.5842539062971467967 -1.8675700490398345899 -2.1161953835941700319 1.6973062828641001243 -0.96459532542493131579 -0.29433191546861842136 -0.81482750813537263568 1.1545304312673014824 1.1815111908144189101 0.39003302024164759887 0.084451802132977524251 0.60967611930239884455 0.74045639978233945833 0.67115848515651932438 -0.091668901447931785964 0.35482157128727581652 -0.27418751130991697584 0.24362825182759573206 -0.12550109383141139219;0.19634778929304813611 1.3293023638559540167 0.27696887119032570501 -0.22878049901299149504 -0.25931445954367654538 -0.46770222708575714954 -0.37873268689767858319 0.49049960149137827869 -0.10749193002561753529 -0.40557397605758055414 0.19970515052337886597 -0.0030191264508723720042 -0.36055029059676674263 0.61286574875121957451 -0.50839051930164902426 0.0015926639875367834889 -0.25436437236363440562 -0.33860109030285623355 0.023016265119521310545 -0.96355091758201583119];
  
  % Layer 2
  b2 = -2.4559186683741862645;
  LW2_1 = [1.5175435647459663002 -1.4246064893597694123 5.6735475710232066149 1.5895023957106162449 -1.2352074247246087602 3.8181801575846425756 7.742949963124075019 1.416171867467745038 -1.6664183402064354222 2.0495424163554525343];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

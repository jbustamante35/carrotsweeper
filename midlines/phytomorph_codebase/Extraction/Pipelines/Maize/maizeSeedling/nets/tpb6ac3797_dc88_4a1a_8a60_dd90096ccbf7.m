function [Y,Xf,Af] = tpb6ac3797_dc88_4a1a_8a60_dd90096ccbf7(X,~,~)
%TPB6AC3797_DC88_4A1A_8A60_DD90096CCBF7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 31-Aug-2017 14:27:06.
% 
% [Y] = tpb6ac3797_dc88_4a1a_8a60_dd90096ccbf7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5432.21511079255;-863.132365464486;-1030.35626722576;-451.327248716541;-690.442124301688;-440.923810847592;-781.659803211381;-448.474762490207;-659.850047510502;-416.874768568233;-250.644035779541;-272.098158795933;-284.166721828084;-200.812705665949;-311.371005878049;-287.447714627305;-270.705877196563;-276.019527491478;-161.960068441806;-167.395512111995];
  x1_step1_gain = [0.000193639844679507;0.000635136090067477;0.00107257204462677;0.000992521373387897;0.00140098678161599;0.00179249040902968;0.00152180852073822;0.00263160812648067;0.00198686103343281;0.00250748142155717;0.00458743324706907;0.00371176793861503;0.0029677820728188;0.00448915093377877;0.00365879017755089;0.00377014651183256;0.00363538636865107;0.00429258503045397;0.00587388837253284;0.00612684175841725];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.25803459865890443492;1.6884889386809520673;0.044266149703476441457;3.4079116197991754511;-0.63657870020467788308;3.1554388784196802931;-1.9729459167958127708;1.6620820732325185531;1.2031408082653756164;2.4127146293150190104];
  IW1_1 = [3.9286178730062366604 -2.7366422248443083021 0.60291163048785112455 0.4377533102014305455 -1.40004354441859169 1.5358256546710682411 -1.8388932309595573678 -0.83932823362423791824 -1.2928866433738381847 0.70001466631536068963 2.2000363224358112646 0.26174826232616582589 -1.3347307116662974202 -0.74940699000786714645 -0.19301817001084323189 0.38427719405630028637 0.54138238096398205723 -0.54395455490412270017 0.58290045797064937716 0.55927452631186536092;2.8656165549592902408 1.2054527288006764429 -0.1314765544986397916 0.15093361257503778994 0.18940955930935707285 -0.14642839178126546007 0.87008779456155183052 -0.66998859144307854052 0.86319866212952389706 -0.11085955074069107906 -0.60275000404067713422 1.2869376199373459002 0.31802317106915783951 0.15189985578053236126 -1.1310073862650589227 0.18699030986333650683 -0.19499422728708154517 0.36574928328801359356 -0.29750207382935939249 0.255260849108855159;0.045860397753966386514 2.402331272875629864 1.8452089320428102237 1.2012420191342443321 -3.9148473484436014935 -1.0995061518935158595 4.3820149377624133535 -1.3192522290171271315 3.0263840560938395363 1.1942366096845402623 2.3716020582547807649 -1.8644756674232738636 -2.7246958580910547454 -1.4167461527210329919 0.78638571569692938823 -0.76176596462197831983 -0.012571228865963283983 1.5859768092628929725 0.80204012797783663657 -0.1063435928519266549;-4.381787436753648457 1.162855908218375145 0.34346923180038019252 3.429082143970775487 -0.69140763595510379425 -0.202385754931865669 0.0025949310346024684337 -0.1250381395251422556 0.3301947803730667097 0.39777437195175846529 1.6293470792395192692 -0.33319612238756118883 -2.7008440617890969726 -0.59909283202475804853 -1.0722920868809988626 0.96761606760068230582 0.54081332352525823826 -0.012026376959878074674 0.37245238799625024484 0.30163243452812915635;-1.363756232250872058 -0.087973227365563386182 1.9628879186632313125 1.2918732701818358422 -0.52437017902835558747 -0.21539406681872502736 -1.6293930016365054669 1.0966135166804067413 1.0183533964845778996 0.3001418234996129919 0.14231302164981296521 0.02833373634431078647 -0.59943033197421513592 0.44376319715052792159 0.57186460533913752169 -1.0956955012919893377 0.64203791913636498734 0.73913894898445742232 0.30877628866821044129 -0.090422403626201519611;-0.76115393639089223843 6.33441480015312397 1.1514265482264254281 3.0466352718176024084 -1.6626034672453706698 -0.73719449142264004138 1.3197221292471081888 -1.9218695155131826358 2.0955243072384184266 0.18803709231834547788 0.89852500415882874396 -1.1314677506353183478 -0.24238963931072393665 0.64353624857523561431 -1.020061250537386055 -0.079532318554388678478 0.82419967166323515606 1.5048317730932816438 0.74055300704230775377 0.91319980116338672627;-6.5393426950122970354 -3.264561144572959428 -0.1848922775983833644 -1.0329011083298351714 1.4967278815020663707 -0.45426060268885942728 -0.89115044032992618561 0.85450801406444576447 -0.87323302516241763094 -0.20536213469827985234 0.11571527802426073706 0.61632962984346717494 -0.037120496310181112787 0.56601179842119686558 0.75491170321980649582 0.62930502695822965187 0.41090813216111315986 0.85180063854342646934 0.082238139170412338785 -2.0175559313021387275;1.380948234735664748 0.55129664600492467308 -1.6537553886067746234 -1.0928830999374377075 2.0156697771664817687 1.7151823366240941393 -0.37590008651933004558 0.30723953472607262727 -1.882902057240907201 -0.64353395592791040603 -3.176347841596312005 1.698597806612134109 2.6594068476269678847 0.62967672266635299483 -0.44105058346614611775 1.0961011890394150026 -0.5234766537910741091 0.62492451350844802072 -1.0051482764930712577 0.90285445163522337619;-0.0069938306793417351348 -0.3372754859124433291 -0.051236054679265327638 -0.42186520761499818333 0.78552098617927701429 -0.071779289583539615527 0.24131764125761701045 0.72651719959361016343 0.97189606660028571294 0.35912716003087802319 -0.10124343512936440082 -0.23596399358337954988 1.2010054952183990551 0.20884759942997455084 -0.29970261080842702794 0.43356852320729144523 -0.36047243757553315557 0.3864372262922240453 -0.18471831135581262551 -0.82807694932153275147;0.25017168975345938087 -0.85634045357317267744 -1.5925938156851395799 -2.0363498362348488868 -1.3311349454825149863 0.66459815307852221355 0.19797996348459273586 -1.0383001444768436006 0.21232114580858518771 0.4718264768155312483 -1.3895873838046202131 0.084927115953107784607 -1.8173286199848572853 0.047288943205145830828 -0.38460318340741533882 -0.95695112005232563224 0.79390040516772475421 1.8528288309531040223 1.2094790474848269302 -0.41170628965081218498];
  
  % Layer 2
  b2 = -3.2582971743600577241;
  LW2_1 = [-2.8771345012780971118 1.9185592573734071564 6.1880719097615646263 5.3364763672097152991 -2.3830596981707601323 -8.4162276581421640032 -5.4301614322998030815 -1.8756508567136647159 -3.3231770868578331957 -5.3518563512346837285];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

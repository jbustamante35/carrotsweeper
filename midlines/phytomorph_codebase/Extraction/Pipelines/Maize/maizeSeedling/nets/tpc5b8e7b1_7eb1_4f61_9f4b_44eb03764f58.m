function [Y,Xf,Af] = tpc5b8e7b1_7eb1_4f61_9f4b_44eb03764f58(X,~,~)
%TPC5B8E7B1_7EB1_4F61_9F4B_44EB03764F58 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 01-Sep-2017 00:56:05.
% 
% [Y] = tpc5b8e7b1_7eb1_4f61_9f4b_44eb03764f58(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923585;-833.97876772189;-1562.45386611791;-733.512404378792;-441.043793232208;-783.667639824726;-450.026271289944;-656.555828069289;-416.411813428004;-183.589471391051;-268.74339823523;-384.146123020681;-202.979007080789;-313.061223282002;-302.321350914872;-227.243600249794;-191.974128700856;-162.786711803926;-176.06281702429];
  x1_step1_gain = [0.000192953812201725;0.000635170113819407;0.0010737117105794;0.000992967389065703;0.00140247416929524;0.00179426803546528;0.00152094087103247;0.0026247520165371;0.00199415494766513;0.00251075910029928;0.00454433874041205;0.00378662000738728;0.0030223773794896;0.00448879604138663;0.0036608073346031;0.00363057230533679;0.00381924645546937;0.00427537582274462;0.00592120551781298;0.00602422138644383];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.1624472908647764946;-3.6590312783085980897;-4.0064699726203301111;-1.6164035237819815993;-0.90993789148192494309;0.54010114200769021586;-2.6906501734406358395;3.8298251690430129557;1.4203396216848065414;2.3111553353771498998];
  IW1_1 = [0.52007440039617325311 0.52718569343570043095 0.12601023206331127269 -0.78434398441682950942 -0.16320673378924024921 0.32437266385196023011 -0.2848538057464840012 0.38939843108415472805 0.23328039569716804702 -0.018460544435132036911 0.41339704086788325865 0.15939666475575639537 0.021210955972049205104 -0.0020104508914386841519 -0.34583951116919109392 -0.23858221452994712863 -0.075348025609196594976 -0.45268653344287129725 0.66303783118406312003 -0.58599156228209325903;-4.7649916744738209928 -2.4765851006816972379 -3.0973229858007473858 0.66464595402223958232 2.9603129627848692174 -1.0543409717374883083 -0.32462612276314073423 -0.0019917438229924309609 5.2309569356065308554 2.4140825994762975526 -3.7484156128317640544 -1.5784134813224139915 2.9637962312799777109 0.23181571861296429438 -0.11432273215391353105 0.0051976807331604469448 0.014589185022316207216 0.80576341642853144265 -0.70960181849712233859 1.0219454817281601322;1.4018259637885612801 -5.3990523596054762479 2.1825934038316989749 4.4305299180565418382 -3.7220816079900744811 0.56738130579567913614 -3.266923987019306086 3.3922370775981129931 -0.2439554162975220708 -1.6125497075635364386 0.82829744438075647572 -0.29130201309337450111 0.019034966468297220832 -2.4715838442650559514 3.044414133361410979 0.060092226581275845487 1.2907605991715525029 0.91268864695465279357 -0.73321073663122782182 -0.33123727847304762495;1.2733165998083879611 -2.7604615756468420251 1.2908097901010904263 0.43378449496999632595 -1.3526929052983025503 -0.32904694228952857671 -1.0719225338654596591 0.44673225377318614981 -0.26018241423485882757 0.24091763011628553048 0.76877993409539324698 -0.061106444550124157378 0.14371708392800808252 -0.69567403006766803664 -0.2476658438903616144 -0.39154244594971587823 0.68097476466220407954 -0.11008368670595788941 0.21570916960027000653 -0.44300714336132668292;0.27786213920957492096 -0.69679874616174508617 0.45783880400472742878 -0.019189293542685680743 -1.0360232235600528305 -0.17221837312818283339 -0.64574821703180373955 0.6391190335391242483 0.32807078304900511023 0.29755890229180553819 -0.55674953364924750776 -0.096393476940843464407 0.52433218287599880902 -0.38172549814034623106 0.98424090567696509435 -0.046041095742389168133 -0.12784257666649140317 -0.048123539015288166465 -0.55225845116968907966 0.37165389018904693152;-0.47971104092881045045 -1.2788995271218217553 -0.32654933653912182612 0.41396746057592986867 0.90856525261418064066 0.066214821004558527262 0.58898367259081552127 0.50672253156582092171 -0.06176667557516024587 0.58293354898065674607 -0.34194420093017063866 -0.013075636093685543554 0.73663860680749304599 0.35028322964849945009 0.5807240634174786198 -0.2592473565188854745 -0.29495788270892564498 -0.43838532015827202937 0.31905318741821742101 -0.25335239362667111296;-0.0091585719121891201455 -1.5645494702863094183 -0.90423036670117740154 -0.16414415046691130384 1.6768848390922128644 -1.0353904270231495399 -0.87804118840451861328 0.4061638204911963701 3.2802163829307220411 1.5731930976436274694 -2.4908622448833570573 -1.2992321985815533658 2.3490831136646459498 -0.27843389049153421944 1.0888897973464239932 0.28312350572559985551 -0.15262318696774232474 1.0027734910875238938 -0.33318007933191068348 1.5923147294991968348;2.486303289912786596 1.8216580685075036694 3.7637849170026829171 0.43478478594914787836 -4.83598680247292112 0.98818934973114147535 1.0420350011173129534 0.31369618769478480047 -6.3959473208920609721 -4.139103071642742826 5.9952301386838131592 3.2386915890659881967 -6.0427709789001289309 -0.082596724665522897046 0.3240537363455860409 0.77053183825701310194 -0.46840336442152630259 -0.69661970933889250102 1.2801309878060320724 -1.6224412138396491212;-0.23544087027456714334 -0.41285101411460778387 -0.65745397120045923067 -0.45928548493901194538 0.055526911589395600011 0.54780773045771258278 -0.010180177281637621534 0.40197437287353426916 -0.060126691013199215496 0.16206935482437689888 -0.28774950036940694087 -0.016495139651453608748 0.39623024195044354023 -0.064686357931587265546 -0.41117091678119127574 -0.25844933160828298391 -0.70128572847656112099 -0.2117524502107564488 -0.21667270018128864661 -0.52692229269093859845;0.051018482704656656357 -0.38801917711818062484 -0.23654268211927051424 0.68550426968884403678 -0.29698620238924444692 0.25085808962728939342 0.23504011165173327447 0.24992200061861005733 0.69460833483208272998 0.30356321402107117047 0.26036253991581925771 -0.10606158630814439825 0.37778476815499900665 0.26721636355249789307 -0.058471415944663394926 -0.44340905313468320648 0.0038515119532199649371 -0.22879039488044244921 0.29946960725277388393 0.48185495101713859967];
  
  % Layer 2
  b2 = -4.3823194011373738377;
  LW2_1 = [2.9394579059857854908 8.0114623511601745776 12.7583597461099707 3.286893496925801017 2.3601183520862409893 -1.2727979316056643455 5.011481151238732501 -11.571651389236102148 -1.82972250375061396 -4.5949703145849687402];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

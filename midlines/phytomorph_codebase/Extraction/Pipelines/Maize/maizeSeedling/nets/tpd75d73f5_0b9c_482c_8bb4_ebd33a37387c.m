function [Y,Xf,Af] = tpd75d73f5_0b9c_482c_8bb4_ebd33a37387c(X,~,~)
%TPD75D73F5_0B9C_482C_8BB4_EBD33A37387C neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 03-Sep-2017 06:54:47.
% 
% [Y] = tpd75d73f5_0b9c_482c_8bb4_ebd33a37387c(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-5466.61789079662;-862.937878923584;-1028.71862143181;-451.710971542901;-692.538815519989;-441.043793232211;-783.667639824723;-450.026271289939;-656.555828069285;-380.16002803684;-183.589471391037;-259.432124024265;-277.584610398759;-202.979007080811;-313.061223281888;-302.32135091488;-227.243600249779;-275.821003918791;-174.982344511288;-176.062817024335];
  x1_step1_gain = [0.000192953812201725;0.000635170113819407;0.0010737117105794;0.000992967389065701;0.00140247416929523;0.00179426803546528;0.00152094087103249;0.0026247520165371;0.0019941549476651;0.00251075910029921;0.00454433874041192;0.00378662000738716;0.00302237737948972;0.00448879604138529;0.00366080733460382;0.00363057230533645;0.0038192464554691;0.00427537582274535;0.00592120551781278;0.0060242213864434];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-0.3651739230199969044;1.2385275497968433189;2.7000239914688823895;0.11983549743638337304;-1.1008523609241329666];
  IW1_1 = [0.21967254740324260176 1.3362669953766155295 1.6883949085554288416 0.59277956262151054734 -1.2184137150281353357 0.78336073592912058849 0.007069930334570245084 0.085026538044322169663 1.1637606182358832818 0.061489503006647378003 0.019557802070603352157 0.30254223888938758247 1.8382597596471959012 0.64647606083295972024 0.077079136822235300164 -0.0050206178168423218691 -0.76507842538974890623 1.0714143246292102685 -0.53844061710962487499 -0.53093312947447146577;4.7041062224727365759 2.5729038919997688772 1.6217212983571152041 1.6948442112487143163 -0.9529463580382926402 0.36351431229250569244 1.1337865753492206711 -0.31029813003135148231 2.0693616288830161132 -2.0759227924733383297 -0.49305840492677699416 -0.084580330993207442081 -1.0077232790189436518 0.98158470309958700817 -1.7502951152606911478 0.4540508290444082995 -0.56116506131010635006 -0.50353435586322869977 -0.58976024529158266319 1.245477027659062097;-1.0473779469411494958 5.4458217483116841962 1.6432516130437069268 4.2535094512637314779 -1.1413321317627111995 0.81601602988553767482 2.7086249153280181901 -1.2006067806422702215 2.9670973246283809388 -2.2574513406492813239 -1.3573737630431756962 0.40900847700352765957 -0.56098507552321019709 1.8265617582952036191 -1.4644751676037806032 0.52177342953828353966 -1.5784159060789151319 0.87497289128443911377 -0.63007948544277070368 -0.37085149262946059956;2.9679051882552474062 -0.7352784880821368052 -1.3773672249281849744 -2.2004072527274471938 2.1344743004789519247 0.045215890641516182091 -3.8439679558569812556 0.92153384258751480651 -2.7751231514681298229 0.17392012194501893507 2.6609213649963256998 -2.2596550895899643052 2.9527783365226021317 1.3028880223208780809 -0.90106446968147801968 -0.1789388147916091687 -0.74184270858112966174 -2.698112925656092731 0.40914956195446516851 -0.28984421144576127949;-0.45805359748208457349 0.44908086275111130936 -0.31649498451200863691 2.1101273090822707523 0.55062228745337271629 -0.69386704861581449677 0.74586971593797213309 -0.16875833121768302192 0.44981726800273746925 0.74334593620011490955 -1.3902933337990452944 0.03740129303325863408 0.66939675898952955002 0.20739597972402326609 0.74040955355781457037 -0.13068307606566087475 0.21877929224455669455 -0.72791450042118543973 -0.14606220083548498989 0.45073220958870480191];
  
  % Layer 2
  b2 = -4.6715841568800433592;
  LW2_1 = [-1.7487502743112988135 5.0569883655290315261 -6.4623200473234438945 -8.0233894344850789082 4.6587101483821529158];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

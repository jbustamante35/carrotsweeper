function [Y,Xf,Af] = tpf8563e14_0da6_4dd7_8bc0_e59b9823ee79(X,~,~)
%TPF8563E14_0DA6_4DD7_8BC0_E59B9823EE79 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 30-Aug-2017 09:33:24.
% 
% [Y] = tpf8563e14_0da6_4dd7_8bc0_e59b9823ee79(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-1752.79194273022;-1612.14400693261;-780.471896742375;-460.205555216351;-234.31060487846;-540.291178237134;-572.142715533789;-192.819908210792;-263.800490630851;-210.820779921779;-258.183122033527;-286.590370604326;-190.320782432688;-193.663740648592;-194.470619647335;-373.104709120369;-213.719449945763;-260.914631799832;-176.115238468631];
  x1_step1_gain = [0.00034254044244578;0.00027748074658588;0.000806013241167019;0.00156677380853904;0.00168393926281428;0.00269046527889069;0.0019808499204541;0.00236361816544284;0.00245784730269613;0.00195235680232595;0.00282106579415898;0.00424658079482957;0.00317261769260757;0.00555458687461902;0.00429724736478091;0.00484270636687465;0.00333931608099041;0.00598913897545093;0.00384783002604042;0.00642488839732238];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [1.5908469901596236085;-0.2115986853938324197;-1.4939602263465139309;0.79343193044213244924;-0.77244699025289365046;-1.9289349099910422236;1.1176172819405028047;-3.7591071817797652166;0.48871930752413722532;1.8594930934326330263];
  IW1_1 = [-0.027738797738237779 -0.24284142264651956133 -0.26508366631330515517 0.19930925355148637612 -0.21787349736231353958 -0.5402297453038074071 0.43879932573509933258 0.52594469985216363295 0.11369133875511763798 -0.063764899808712693918 -0.28717369554487059968 0.81503324981734426302 -0.62620691576876030826 0.040132171611544420475 0.18412745236975477936 0.10072511777216218432 -0.12336538529820800791 -0.22887648892205816886 0.82433687761613927414 0.46697307140812555071;-0.29961501121381001189 -0.74505724316833799037 0.035301130989038906338 0.82171359163015433857 -0.45877122248320728604 -0.96125138735881876517 -0.29346817577556172374 0.40107319431824689504 -0.41598732619245659681 -0.980287510189525646 -1.0617749523445574322 -0.4689329976120757415 -0.17082124729907358085 -0.25589829069140712647 -0.73142698033042707895 0.40957983261714286938 0.49484868456449515595 -0.13822846697698484841 -0.29267978361755414562 0.32058068438556031055;1.0807644404697265283 5.9904516853397904441 -1.0957630873419899054 0.58813560654027075003 -3.1799488848309001021 -0.51948426976215000828 0.38469835133523883064 3.9025816779656583577 -1.0398259374905332031 1.3791877280796365213 -1.7553222549350802062 1.8767938005262929657 0.90964178376373261425 -0.84823697476515502736 -1.5458314079428463472 1.0523951272901663767 -0.61668103691321407567 0.020610939755588982003 -0.79006005842869730937 0.83803139856650765704;-0.026970433754246615071 -1.3527212503992882553 0.95064201916741297715 0.26901619837778151245 -0.77458202266748044096 -0.17481039015132027181 0.12470947251628126951 0.76694840416524612259 -1.7211550859361317567 -2.739990786372085374 -0.0029436452723135666035 -0.49731905607302595573 -0.67422496805833220801 -0.79128597356684071684 -1.1272284624208150916 0.13103276413262524014 0.93362034826825923695 0.51612586769086477023 -1.2931966911789682939 -0.075885791373087430056;-1.8944629304576039441 -2.4395048632548985701 1.5542368104805828199 1.0482027233633299801 -1.0768536793947371955 1.47770152976036373 -0.57528379334864565564 0.32414375570875014754 -0.35253564859633701456 -0.49230159749292856652 0.94055687830386236481 0.28753582715969344674 -0.0087969801610536368236 -1.2385834628652199196 0.022363902003621264486 -0.60551783632297573323 0.32063057099052577614 -0.24986081358476219805 -1.2287989356384005912 0.19571898275731977601;0.54278210721615627321 0.80449641606617172673 -0.58545693773689688744 -0.17935651594366722184 -0.22447502759867810074 0.19903107672552827756 -0.94058722063057542684 -0.051851117241354216514 0.99697309682665813391 0.21898421565755007978 0.94133945140221864101 -0.37208578529140007296 -0.040710858331037387547 0.21023086838086177397 0.13882300401539651724 -0.2456988853292597641 -0.39469027475061635446 -0.69428015624836569852 -0.57763297030704641166 0.49144221463455456389;-0.26245361432616814978 1.4309158457898341066 0.80590315304671167329 0.077393987528413712984 -0.58646888326977497652 -0.04413011997073820053 1.2370514813358532979 -0.87240869486369443386 0.42785604345187366881 -0.28208859943952729887 -1.2245900944361378659 0.27276304391232775171 -1.3643254408802802935 -1.666069798452564088 0.36570297029214560158 0.38583516247742216665 -0.73808089670237297941 0.44115961470625497665 1.1105691423418415642 -0.44247610406449444653;-6.0357253869428069137 8.1741752646289533857 -0.88747309468395607635 0.38603158177319457645 -4.0708634825010356906 -1.066116197166828039 0.40100791913239069997 4.2911070439124214815 -3.5291731296828912079 -1.8513603259172790594 -0.67321396115862597309 0.43886735163958251471 0.98331118060936495429 0.43789181444469132964 1.9664943615466468074 0.58855811630744581109 -1.9157762727003506686 -0.049114011965788892389 -2.8779387498965283143 1.0936643592792252289;0.23265277391068889257 4.6823973851523161827 -2.3935696307312652742 2.935736017141622245 1.170395113274354193 -0.92074134454121914217 0.95345372994995647442 -2.5699414763344132773 0.42683230158522555975 -1.7981448522725387296 -0.83943187575088540342 0.14185243161487987029 -0.897618966979874644 0.74432019357762801981 2.0832060740368456564 -1.3373745311364240163 -0.89880457623185583405 0.87699220830151636275 1.2631213931218183699 -0.31060330860519208551;4.5922185183013128906 -0.41224432204151256753 0.36731527530456936637 0.81825277092036841076 0.67168372100857576257 -0.95692231641360969707 0.47434886265120951299 -1.6197017791404910714 1.1508285315174695551 0.95675277006962977655 -0.4411493490449564514 -0.0064648032815662241982 -0.54854279646194448183 0.47818991963322476924 1.1772488380242476236 -0.74952017735036013946 0.062104306041156888407 0.30485737556650538416 0.84816262140192488772 0.14734473263078459726];
  
  % Layer 2
  b2 = -2.8474905968217072427;
  LW2_1 = [-4.1248461861660867811 0.56593683147218010188 -7.4522918368967152603 2.0105579373847959346 3.8647785671781855754 3.0038179473770729722 -4.9908793024024724616 -11.259080207446778843 -7.6928675313965078075 3.3772719528214998341];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

function [Y,Xf,Af] = tpfad8c958_046a_4264_8293_21f5481ec405(X,~,~)
%TPFAD8C958_046A_4264_8293_21F5481EC405 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 01-Sep-2017 07:57:30.
% 
% [Y] = tpfad8c958_046a_4264_8293_21f5481ec405(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-1874.99930442497;-5454.91534726369;-869.204807020145;-780.471896742374;-460.205555216351;-234.310604878463;-540.291178237133;-572.14271553379;-620.900292310254;-760.602424664796;-210.820779921781;-212.78401520665;-286.590370604325;-169.741999038737;-193.663740648595;-194.470619647335;-225.82032567502;-213.719449945759;-258.858847398803;-135.174215342505];
  x1_step1_gain = [0.00034254044244578;0.00027748074658588;0.000806013241167017;0.00156677380853905;0.00168393926281428;0.00269046527889068;0.00198084992045411;0.00236361816544284;0.00245784730269612;0.00195235680232596;0.00282106579415898;0.00424658079482951;0.00317261769260758;0.005554586874619;0.00429724736478089;0.00484270636687463;0.00333931608099048;0.0059891389754509;0.00384783002604039;0.00642488839732244];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-2.6612167019559924697;-1.6220135130067487861;0.63226988586507248957;-0.18737301679597204163;0.36322616952525410561;-4.4425674116869879882;-2.9543384167789801253;2.3727741297998661274;-0.48415346680636239807;0.58629704996862841426];
  IW1_1 = [1.4120108795104702182 3.5419354219725258659 1.2293603462278026583 -0.64184760435736187834 1.4486053590990066731 -1.0291840848858739843 -0.84472359556196130459 3.1015579249410465401 -1.3965384340645428107 0.11854384885178601006 1.4033647260317936301 2.0729140582851242058 -0.21621587492904695282 -0.84273474324909336541 -0.99051185179433920425 0.083416018309015654841 -2.7358030416207950175 0.27421707419405888517 -0.43572537393652510662 -0.63856920664951821731;0.29554139436480625358 1.0808317072027824324 -1.5736382301305757991 -0.71742484530430084 -0.51954262155746266938 -0.51445828661734471776 -0.40525393517135865906 -0.73885762513337593926 -0.18318911477590607562 -0.42273666998235098768 0.74774086191852029426 -0.002827026755709799704 0.63266608967137050179 -1.1496470726419962816 -0.50532756222955244052 -1.9366355452499737222 -0.97209268169135421012 -0.57754297096544282564 -0.2237382788208147899 0.95950820154386828875;1.8025199834993095305 -3.188540808348174771 0.53920181550523593739 -2.0683743891806845028 -0.40070016373224953687 -0.0080172247769178216215 0.96071447025806899767 0.60080618757405834796 -1.6030070032276264591 -2.6480886098465332701 -0.41749481754927836308 -1.8139338816373880015 0.36495478827992111626 0.06548595030237031045 -0.20071338163617113981 0.81396639516059843267 -0.68521902220578867482 2.2294375575178415616 -0.90707584196787804931 -1.3355923267616773842;1.0365709823166529002 2.6801572258734873699 1.8033767530600242068 -1.378097357316280025 0.065433964638159439198 1.4898697999790599944 -0.57073041357691212117 -0.85365657829127850054 1.0700936649791463751 0.93455595839891392185 1.8290853956016095427 0.60736809918301470912 -0.83472599529403157526 0.46501435513564870483 1.2372632083363088729 -0.27127821932319556852 1.0716687331074790102 0.53157806738023261062 3.8732194790050944455 0.30648759170232786619;-0.11374307517806195311 -1.5555074722318706915 1.3803810523202186822 0.083709162257623648262 1.2138498100900227961 -0.93500761678734112259 0.065806612497719602084 -1.0324378228944275371 0.30575211850968830873 -2.0113368371542699187 -0.76578446840894853764 0.94904167620908830294 -0.25311972516017766655 -0.59471995289491863534 0.79446087265852483039 -1.7446396378552200268 -0.023330873194769292944 -1.4177861937471267773 -0.83026204694528171757 -0.48042727995346301562;-3.3734033004704189196 -2.4945802362622297998 1.5369572496496302083 -2.5470066023309883008 -2.8818604179661462261 -0.61594617918452598815 -0.87629992618327701148 2.8709732880248557407 1.4776819831428356089 0.28007653690778927524 -2.3472710006210277811 -0.47234867424290744031 1.3734137916377708866 -0.49920438502388314594 -0.66667433682552279528 0.12381458578330012399 1.1615413554442992616 -0.61311515299312313587 2.0482550543408284405 -2.4677924798873558387;0.63745909666834343899 0.40239583261209199705 2.2184482110261249943 -1.3060342621467866397 -3.5492678117045506347 -1.8402850931828922398 -2.7614903448213610204 4.3934988521089266555 2.3644440909823867258 3.1625309543101876031 -0.049080920904766255075 2.5965881324644071171 2.8798683564750748864 0.35675421746373692233 1.9508629570793507568 1.843748019578366204 1.7041675518340795303 -0.87282831088099999128 4.794142568166940066 -2.4478500725946714667;4.5874273518442887365 4.2911401767438883681 1.6107540669911570852 0.27658593213791432541 2.6362318077210491474 -2.7709567225723912287 -0.96975238131718122236 -1.4264376134776255434 -3.7141165334100980644 -2.9946294642025961252 -1.0341092573320380676 -2.8285720270035858981 1.573312963040731649 -0.9057741845736509978 1.7218280787947828347 0.83836586055712725152 -1.6769238636790009256 1.0876628611693155424 -0.24045801555909995795 -0.48748781349038444732;0.65140484731758041548 -0.1722144785598146155 -0.68873802264099603931 -0.93416201860805458956 -1.0200455370420156154 0.55116213761958909867 0.6942319753463799259 -0.82701298614942619913 -0.041620835358244824553 -0.13887374000288657538 -1.5008411529927445649 -0.39859460344971547885 -0.81947920078634395313 0.6833331098535716519 -3.0528995751307439477 0.75353557986202202024 -2.4243172493768079256 -1.8196865135348285758 -1.4070450637190048404 -2.9736841889366094627;-0.68631142379330434267 -2.2573025871917899998 2.0169172749231094599 4.0808536832959916296 1.6607128368076278235 -2.733445351715912075 0.16816018542938651614 -3.2357976304809863421 -3.2274664446886913716 -1.1454118699394835179 1.1318620451854508602 -4.0625132560555554662 0.24789787816225161698 2.4235555522656793137 -0.32772791442436766118 -2.2794596366580597291 -2.4267923205201888948 -0.69295068284942029635 -2.3076515244215469735 -2.1070711157526686996];
  
  % Layer 2
  b2 = -2.3364093830270427077;
  LW2_1 = [5.2063623787510051599 2.9144628390048352706 -3.7187945667356290258 5.2506030046630653985 -3.7813655705448958599 -4.6037416990577257891 -5.1540041759701864521 3.4606867495358817344 4.7783370991580902398 -5.1117926761167069571];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = logsig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

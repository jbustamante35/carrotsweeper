function [Y,Xf,Af] = fftNN7(X,~,~)
%FFTNN7 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 24-Mar-2017 09:16:08.
% 
% [Y] = fftNN7(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 20xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-0.913045608368196;-0.697742834656546;-0.455258159808926;-0.350773478419453;-0.341510968401377;-49.0053039056943;-74.2569817395322;-54.4179107076702;-54.0173944572861;-49.3577555023209;-0.000809726559050569;-0.0013602606530604;-0.00146328627525471;-0.00149716143554126;-0.00168341702480117;-0.00216755798705442;-0.00195351338232348;-0.00251211702556918;-0.00180428615074732;-0.00268405977928543];
  x1_step1_gain = [1.20478154368001;1.48846702877638;2.11403974925536;2.72216108078322;3.77210398358307;0.0124437578985053;0.0144281183648748;0.0162992707192427;0.0167582333008573;0.0190784070422653;1036.50533353783;712.60385144272;620.397298639487;686.558993024048;573.223015277061;498.654879142627;507.971506982535;479.181570477997;411.884775569176;443.322639512792];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.6219367146411178826;1.610846100550054727;1.2923519074240856774;-1.1231714594068484825;-1.0351746983668792534;0.91298508538314859795;0.60555180305599376478;-0.42774569286853686423;0.084828475957970439492;0.15080680673872229325;0.21179953084161437515;-0.11148757108300416663;0.42571148438834405248;0.59853412744427825221;0.78336942519853092204;1.1183430275175048063;-1.1303532017668904697;-1.2090770724425716764;-2.4230451119300893126;1.5403262187892590163];
  IW1_1 = [-0.51913279548455149026 -1.6391306645203815862 -0.037154451349238191982 -0.96112297495768006517 0.0081932672949968712861 -0.22622884974809417957 0.30561392013586241578 0.90623580341072329514 0.69425293319430758654 0.34239475511764710935 0.26451744803780286031 0.40408685441505687308 0.40540361457374413101 1.1927819068772174127 0.76783299164709883922 -0.13597448236145417977 -0.027743603152217910512 0.29079136363446034252 -0.28476206386040775476 -0.25632670962109282975;-0.40684422162865413464 -0.97958577554141246235 1.1443738749780414388 1.1433416678257015686 -0.77298509170517359923 -0.28855509738970813727 -0.37640665182473459494 -0.17807007099667276906 0.17795711222529397855 0.10279864064849020266 -0.11370441730384353574 0.46046263812997650922 0.43092572135261969501 0.060150366315760636637 -0.077342559571284885678 -0.03738873321364336727 -0.017273356450041202348 -0.19308938679044920783 -0.055955164166681475857 -0.13456160941654521368;0.13284748236334981142 0.70787158622941159791 -0.55037177057334463193 1.2706551906779592898 0.11906043047682368652 0.20449714585654574228 1.5051956683267895265 -0.31718754643968744 0.54504818712089198041 -0.0073394299306615449693 -1.6320794556368234396 -1.6750976785652751389 -1.7386398792294268656 -0.7523768554430194655 -1.0974645662922528633 0.28875516700321290919 -1.1283272688361580816 0.38008569844772366331 -0.46400600676998798866 -0.30899715558646151381;0.38181323683564005744 -0.71336340514054696893 -0.38623247367164836863 0.30007387016670877822 2.0339499662621380871 -0.56174811705258975714 -0.94127003416619570153 -0.22890207462497863533 -0.25427748770527069944 0.099433620198404029655 0.94070505323400765985 -0.034960636279913089031 -0.041716080651693021597 0.58282426566599521145 -0.37990871289223948626 -0.50147940887525765952 0.99842574437554643119 -0.39921478272564975276 1.0975800150844343683 0.4917826976315606835;0.29507194737502689952 0.72049298305339870563 1.8563088556745896973 0.39372885658486878047 -2.2981565313984355647 0.55268746443369476395 -0.99082238325014515556 -0.80981792601794844177 -1.7980946645917552651 -0.14229352091259098168 0.38928758508561667195 -0.45574500425407232784 -0.68808081792618813743 0.16191182556172858953 -0.7018979741531268246 -0.078660950930227929723 2.6622391182070570537 1.3073159195961099321 0.02253226969742969793 1.6460451455529170328;0.088755389140143955973 -0.32685716638948647539 -0.084095264272195976996 3.3851042471445320636 0.19211918076944850542 -0.39399077893455913824 0.0035554475370536539267 -0.81454553980671962066 0.11753762332647604838 0.00068628567001940846484 0.2426158602441511325 1.9288652522584048832 0.41657704058028111049 -1.0290172789633234007 -1.2755841062739403657 0.078458767807840293362 0.10149458163240569764 -0.64876565244315032022 0.35199810904811490442 0.039288096252962777244;-0.31973131078537297967 0.48747578830044074882 -0.54399393286022279526 -0.16719546741193649919 0.34659047334219000858 0.053317643415659830841 -0.21819231619657478149 0.21867328401467872601 -0.36364130454514442814 -0.24382145994997839189 -0.66103189917986093782 0.45062430857479968127 0.66127904864330422363 0.11359405068483856283 -0.025426236052053800135 0.16960909812924926388 0.2411857259799598252 -0.60006528845515849646 0.201391071892389667 0.13275299446352728516;0.38942657908403466305 -0.25736236561092301622 -1.8745663184876302232 0.45088353874322428805 1.0393294395397527641 0.15540615925512141215 -0.2507330478810071428 -0.23052801550613449821 -0.27024259787520704679 -0.41104443245361660386 -0.093501666619321147089 -0.49036110518508729816 -0.48397388315562817063 0.3353076067352001588 -1.5493537900068861113 -0.024563857434996620027 -0.35408379977258003235 0.64069574683073982069 -0.1468274801631946902 0.22162879409121780117;0.59414347875418549449 1.4089822293325902081 -0.79292481289393490496 0.50498019918554326591 0.51059719891424171223 0.13869277721987346985 1.582092384280353814 -0.64864202491309130849 -0.073508229395005703077 -0.1007395922178155323 -0.92613873554409820166 -0.21250254118128203418 -0.96572786388555276194 -0.76506503405467718437 -0.99725702694795614889 0.81039037631571797515 -0.81152124062261354887 0.35765928453314049795 -0.018787517186483301129 0.24202930514585427324;-0.04299390238712250123 1.2294297140822432191 1.9027523773077736902 -1.2603487973696438917 -1.6281763547241363543 -0.015480482821698948737 0.017668498286022595728 -0.090602435395387051487 -0.90214195315001610709 -0.25243257360150117563 0.2748201240888460406 -0.19984931981861689398 1.0164858536944616496 3.4975584657771894292 0.65559897439758463289 1.2583950842436100181 0.26701150442299464993 1.0149557102402682052 -0.16924129175098556743 0.70183123811997971675;-0.38849327358439078584 0.29590243376715708035 -0.71070014985554930131 0.090185252564136467179 -0.17957369704561035317 -0.2105419264620107811 0.5211199933908824411 -1.4587389018436980326 -0.15218726359813658511 0.34399521061850374393 0.22137238610674556116 0.94352309866336159239 0.028055973865298910325 0.40934270676709577641 0.45156051088672349847 0.11820663629226219049 -0.3109857080949029462 -0.097853904396913563013 -0.46713011395286158089 0.1051240001055330775;-0.047042424839072352616 1.1006990295837313365 0.66627529629403137168 -1.1158163668116645173 1.0488626759185768478 -0.2157752127822645527 0.09386205268171371463 -0.38075651610530886204 -0.16480830513110883428 -0.087117617295744034789 -1.8001511696462606515 -1.2868667950037235848 0.13861395932951092735 -0.42220243399538548434 0.25078020774803366777 -0.18227633545310306662 -0.11131103819754251116 -0.043193150202858507369 -0.43227680240506910492 0.28825351131057547205;0.19677536024686545502 0.71016506528907352713 -0.065572415110540599459 2.644127085703233071 1.1319525373080563391 0.61787669193726446615 0.20222801435243406565 0.16751512679117036564 -0.090849798055783664852 0.064615524508588192965 -1.5337302969862296464 0.4597213938794683652 0.59956724957264240228 1.7294653050381441073 -1.6795261058053128078 0.063190540075216322657 -0.055498074658695120687 -0.22995193438801256325 0.11522103465946195722 -0.4911012352215848864;0.52930669300138022404 0.96750529701666965199 -1.4812623701686369326 0.34073815834102144651 0.52651333390704579962 0.40478683374551754914 0.40286873476746543066 -0.48688770192263008951 0.015057834933669456828 0.32602552657567424044 -1.0926800817408184319 -0.045645854898568941072 -0.73308434690820678536 -1.1320672054156468711 -0.26358661034209068807 -0.38496028349890920595 -0.62350584969092526233 0.24214023008224175304 -0.033715107019252447962 0.51417157864406204393;0.49888762832663779978 0.86430490746082977438 -0.61698822466757685667 0.25750367521442363294 -0.031742426097069807722 0.2030557115464303175 0.27968559984383201122 -0.3056535711745686501 -0.55545903236694604832 -0.040499782654476006172 -0.40729957124857602002 -0.34792712902592826119 -0.52254760315069170851 -0.21428279026319099754 -0.27408503573831399791 0.46942986907010109121 0.68461660347058894693 0.40650228272332622481 0.45221043580899034087 -0.48806913869730939037;0.36407367422027037129 1.4369787039030561537 1.5038373966450591102 -0.82083946406233454507 0.77811849199374161223 -0.17543574086324165151 0.68845429471130736854 -0.47087995758371120614 -0.50261923287643606173 -0.21576405655131755679 -1.696367830001752397 1.192444652717884912 -1.1710145942497920402 0.42033475427750688347 -1.589637421702551956 0.63694946023644960498 -0.37689979800451928194 -0.21508186976096782539 0.1623033626638845095 -0.14584730108358071043;-0.43088935567110969727 -1.5015157463532340376 0.41430760100820690495 0.24685358517091712804 -1.7851889104310207923 -0.015614975592614150149 -0.29586906757660741407 1.3282815928150228935 0.48202615071523169377 0.18554460064807695718 0.65985985728097251712 -0.2664572387152120414 0.32134074705204912492 1.8188407568575573059 -0.74484997822288345759 0.19788588640084184278 -0.27154959707176423711 -0.017917083843581850522 -1.0990543269032353457 -0.26650884243740974311;-1.8166707313963967874 -0.76835765725614502131 2.7428883276892910281 -1.4161548220024346989 -2.902849502131380266 -0.14152471598211371906 0.8731539982796424626 -0.76535830511724811664 -0.032404889244010116889 -0.21336887342106974907 1.0467362833386193444 -0.20901051627385361376 -0.0094852752891105129168 0.57776630809967999269 2.1277732133916558155 0.62395704386212935688 0.56133717735667354454 0.18966067990352014627 0.60088789565102085355 -0.151134777399872966;-0.28931596441569518152 -0.3190280837150045179 0.90670423069236094626 -1.8181504760191200543 1.4079756583439793083 -0.41013745233091802866 -2.0262349609643175441 0.757231335518034121 0.065933393478982027514 -0.39389200394915335757 0.49523003915131941222 0.98428183737960284194 0.15519491764196333139 -0.22288269498092799781 0.46232257439031421153 -1.1667249110582591509 1.1874838773921567725 -0.43215575872338823915 -0.60946600764872471689 0.26699148081969636959;2.5650848456117816276 -0.29470610885157977332 -1.7172986733120094716 0.56692028978906039427 1.2310646066256623055 -0.67056285755465638854 0.10565740584627197896 -0.30750184938826302661 -0.59290445631729205012 -0.15137695308894694168 -2.5917343170733309066 0.31048144653316783748 2.3835089115389429537 2.8388688165719684342 -0.89890795994188432694 0.67795740437687768143 0.72693536674634973149 0.62921724282726310129 0.22239148891702470445 0.76532368878276246793];
  
  % Layer 2
  b2 = [1.5830929826058830479;-1.2212215494358287238;-0.89509015250170165245;-0.52419587642936693594;0.17398471188654690556;-0.18754079061818046403;0.50190970255293487767;-0.87759984779611954764;1.1937286207070350041;-1.5707085583357491831];
  LW2_1 = [-0.45536189384592740126 0.53800996312244797615 -0.06706924738568934008 -1.1795848136136213302 -0.084074859996309050936 -0.036158023468224657904 0.39061010739722940022 -0.72508153672555653024 0.3775793347983738002 -0.52585538152524846645 -0.10985416736169963114 0.35632908484823028195 0.87834821418815123284 0.86517417961838705143 0.069283577596429196666 0.70521448177430146043 -0.19202980972129246595 0.47779789332972932847 0.11810389443275989829 0.076186906224407352495;0.19734507407730247919 -0.71694799364156513999 -0.38284949713400007187 -0.3809797016218223753 -0.22094759987270393142 -0.19535010789422016519 -0.13926773526181057683 -0.32411161254941950327 -0.55298855395061397022 0.49377599938450322803 0.46772749893481324612 -0.63434196332793391093 -0.94182606166585758345 -0.53119683971010445145 0.27676234629943619048 -0.33002691940575407115 -0.57942552007419911853 -0.70687967673968810089 0.47849299483264440269 0.91042112454090307061;0.32940375805031746337 -0.45634825977470427905 0.45148984743909631456 -0.23778491409337737528 0.45908822439059987497 -0.11449168068680203036 -0.55411427812885583055 0.23483828678192400496 -0.44673397254804880774 0.74821291026517577905 -0.62565413274551606726 0.96142786212873132534 0.57006445727950760816 -0.53907863958566082374 -0.11842272606840219262 0.41449691586285541955 -0.069811206883181362026 0.42851401662843746632 0.089855569202470272905 -0.39613433430688560488;0.040958318077383377986 -0.43315258028708142346 -0.49893426892137110462 -0.11877504287506143732 -0.16683445111886330281 0.19738750159076137725 -0.42370259686316186221 -0.3451500371279377366 -0.51714888361111011061 0.36857650195353447442 0.089589754247265715459 -0.49961173969312494547 0.27529852229625706439 0.34832234240643961121 -0.47105894013883931049 -0.80640524459426887738 -0.18914372292734910053 -0.66673634642803825123 0.54322932192873407686 0.76762059615352662423;-0.24323688532923512517 0.59595572183606526639 -0.46619221714342073959 -0.31316846544753479398 0.080092867302727244194 -0.24078468490865584384 0.32420447066347846121 0.12255389780391222343 0.74959904248589592779 0.031896826676475996398 -0.24964598397657183915 -0.099601893531109736424 -0.043273809482141420424 -0.18942184053455457526 0.15613324834527475549 -0.30426303883084848678 -0.57691116670477393669 0.56891557408189186162 -0.43567282594928519179 -0.44301971615211865885;-0.46251757896056877595 -0.58794117111184174274 -0.53546631570465574868 -0.23729483872076986839 0.48983567595752691703 -0.55949214832518912033 0.28717092904010155241 -0.14809299410565010535 -0.71035131560313902188 -0.43606909509236763123 0.27495163838969566283 0.032598030020069099222 0.8694670311590037004 -0.40052776409326501517 -0.74905415041299916457 -0.099653815719960167629 0.082083882932276627797 -0.013190597230891391162 -0.23350754608816212676 -0.765979111558087844;0.050800989560313127014 0.45127944397178398894 -0.72077870210681993512 -0.09327576923729237468 0.45208053516807628069 -0.05666011620183911135 -0.4695865673895383563 0.05487441170617066849 0.41400891878510842625 0.034934542205374785606 -0.7116442013085926277 -0.32369539878258435373 -1.1677485076453377744 0.10846120502219649961 -0.42973364982933409673 -0.5012025999217607497 0.42665191715677480699 -0.14425519718853099804 0.63763398954448446965 0.1093650428121967777;-0.016010549469634736269 -0.014830625183463792827 -0.40336367508828990802 -0.4656784933519503844 0.21711970486320270046 -0.38217073658306149886 -0.5672714058846070051 0.18688181088510738559 -0.1420804756207864894 0.73546009685966406977 -0.40548910320122721895 0.31046898493893421156 0.41813719674481575339 -0.37683571196309428863 -0.46279004561072045743 0.24313317825631483582 -0.37007902454002689074 0.17599719045981004895 0.6671028541910987153 0.43342081486509770327;0.47579916407626049457 -0.51401264158078974198 -0.22924425785248300769 -0.46767199609797871496 -0.50331662814612243562 -0.53931006959125715738 -0.15076225496711742613 -0.44866201602608485333 0.057764373022531539936 0.38327647869332648334 0.19402401182948716962 -0.94610106249548164836 -0.16537266678171141931 -0.47677292288607442394 0.083730334573652254182 0.33925496916394448643 0.57705797128982982969 0.1056025890481418622 0.60755069596137944998 0.11891018482647133792;-0.53313666611412002805 0.14859479197594963051 -0.668410917543419969 0.55197113362303795725 -0.0006368377556606645909 -0.08492783688543588394 0.3674133222163488699 -0.061424010205472258372 0.47145107530452834421 -0.26006406000988485649 0.56653755559688334653 0.060417229099557240302 -0.063741567205290255993 -0.50639800476492891068 -0.046467421247391324512 0.46493726432075327404 0.49048377547930632758 0.021694610095821686979 0.40223400119050872759 0.11592241601605396406];
  
  % Layer 3
  b3 = -0.63044217839608418519;
  LW3_2 = [0.80521372956941184018 0.54426774010460521325 0.28763717763712998154 0.28960392818658053926 0.23480209025521081578 -0.29257557462312983043 -0.1740317465315637524 -0.34995650618001405974 0.064910850327231262025 0.99801736369639904023];
  
  % Output 1
  y1_step1_ymin = -1;
  y1_step1_gain = 1;
  y1_step1_xoffset = 1;
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(3,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
  x = bsxfun(@minus,y,settings_ymin);
  x = bsxfun(@rdivide,x,settings_gain);
  x = bsxfun(@plus,x,settings_xoffset);
end

function [Y,Xf,Af] = fftNN8(X,~,~)
%FFTNN8 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Apr-2017 06:32:27.
% 
% [Y] = fftNN8(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 34xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

  % ===== NEURAL NETWORK CONSTANTS =====
  
  % Input 1
  x1_step1_xoffset = [-0.913045608368194;-0.697742834656545;-0.455258159808927;-0.350773478419453;-0.341510968401377;-0.248410410808488;-0.243762824422046;-37.814712419811;-77.2999656218385;-62.8390877603136;-57.7168681955057;-51.385499051545;-47.2718810468394;-46.1304024870307;-0.000809726559050569;-0.0013602606530604;-0.00146328627525471;-0.00149716143554126;-0.00168341702480117;-0.00172499056143884;-0.0017998233406095;-0.00175941655493562;-0.0016824794955839;-0.00155159651777562;-0.00274218173499328;-0.00170684774264013;-0.00194416495593836;-0.0019908864100069;-0.00165754712972382;-0.0019244988146592;-0.00197568557234307;-0.00185938762437786;-0.627345545498438;-0.34284732265719];
  x1_step1_gain = [1.20478154368001;1.48846702877638;2.11403974925536;2.72216108078321;3.77210398358307;4.00022196758165;4.14564743120328;0.0148707154187341;0.0154726242467163;0.0168242951821571;0.0181235150229929;0.0180997867694666;0.0217675800007055;0.0208504828872505;1036.50533353783;712.60385144272;620.397298639487;686.558993024048;573.223015277061;572.320767918306;560.820488988983;579.081244361871;565.000502323487;496.526505772315;468.279565458687;508.707268940091;484.044536626804;477.272852456575;539.679174069141;550.960631602479;506.56584685886;528.513846648502;0.994134475483816;1.89353347440274];
  x1_step1_ymin = -1;
  
  % Layer 1
  b1 = [-1.5312346647366923413;2.0324604990364476542;-1.3197867964917260331;0.35680470431868333003;1.13551503716988611;1.4493672562533517212;-1.0211891536318691287;0.72922498761894005703;0.60724085364788804586;-0.47895733043370980475;-0.3510215010535743807;0.063881023708961467977;-0.057454578176978479687;0.0037173289271287420464;0.20790070108305691576;0.59306936599131798715;0.49244297929054858809;-0.68238678217298454065;0.69040107154364838138;0.83385119761153292384;-0.9621046583452169676;1.1106603859492125697;-1.1825230386445026998;1.5513438077975136853;-1.2430102423395079647];
  IW1_1 = [0.57703233942035536685 -1.2233949290603265414 -1.8403368293207014172 0.56816325915444876316 2.6473056694531700295 -1.2771052819980881488 3.0748925169091227971 0.34180486118174074894 0.083327811533587606285 -0.36011837010525810099 0.29740839489154868858 0.60384698297096450759 0.023574509808807209144 0.35133464828961974424 -0.13614375148252672032 -0.10702064618472038882 -1.4809202252248918619 -3.4827418211884775268 1.2693839311773680301 1.794220012026061406 -0.92020079123190390291 0.27276224346002708732 0.23668159072825731282 0.027626335634177431183 -0.20001014276814912951 0.22264128608027930478 0.42631203059958561186 -0.2977660170052405797 0.55799006793426686457 0.073833766757691793314 0.83028114076626935436 -1.0066339546646214664 -1.2436847630000593679 -0.13633671844696249043;-2.5442993847595638535 -0.23198511005349886638 2.0340270417084349575 0.44795883803489200403 -4.9087092995186614175 0.58780932484717673958 -3.1498600137491847839 0.37039787751629243973 0.81044320526809443539 -0.45385799269468884987 1.1908707421259674408 0.20001863721452170508 -0.2152000513551788341 0.42105313867015142781 0.54942053185398154191 0.67825884604919317589 1.646834798898815011 1.3375238490356153864 -0.25653261361261364693 -0.60214015838364176592 0.74896541186547294089 1.8217921500243621225 -1.4750651288893401603 0.15582418761786995254 0.15693817818784375206 -0.056320220278163198036 -0.27543060822568105062 0.067526111394459548132 0.071548492183777803732 -0.43499671092384373239 0.87036411344795550082 -1.0774798005833654546 -1.8177149551882474388 1.218792320339864288;0.034283084836699395659 -1.4074422311399232832 -0.019746157352189836615 0.2725904158250030962 0.77417466015039693161 -0.0417848691429311761 1.0334282605635431995 0.38300028576595479546 -0.05469554273438173575 1.4554306282537894379 -1.9733908592369160395 -0.083804277575354510499 0.16039161880364238844 -1.2104922802073780908 0.10819512594587761545 -0.56484520638560931083 0.70444878284354917053 -0.62184859561831673513 0.30040918155433865566 0.88512518878248691578 0.3433445791677391945 -0.23409671092441577955 0.89121543770603306456 -0.24486367668602651571 0.27280740129936842386 -0.57823784027762026305 1.6384240152994005157 -0.0015390290632261529637 1.2114128736530931363 2.0253413637546224813 -0.4636054487217984299 1.9457432760986079767 0.17843471828162016379 0.89845845309748451069;-1.3576503763953129411 -0.93468563407481564109 -0.9553970981822587083 0.68870294611895044312 0.27576948914455118311 0.83001271356327710471 -1.5616703303316070706 0.030141932059838658087 -0.42282778229113709978 1.3113949243789870813 -2.6643771208280999652 0.44031993238473887686 0.066420319054842649753 0.39133928420031560691 0.24761582847083882242 -0.19441241265505515567 -1.7828361968571804219 -0.31487996810355195487 -1.4424303471816504185 -0.74314884984451390348 1.5634181227720569396 0.3199960091576578014 -0.95760605004056165157 -0.11293747124535091775 -0.58685850716459331267 -1.3997305631058329922 2.5539942307004928068 -0.96400360779725791094 -0.43122128927638181395 1.321876417507028334 -1.2456166016940062313 0.28106940285521098133 3.5006512861394716296 -0.015598472441804036442;-0.28189684484019866817 0.71254821119931888163 0.073017535325458945983 0.21671660101361936435 -0.89489975044386538272 0.86561504524388266368 -0.56743834226171385726 -0.40567032521399415401 -0.29123124900042129948 -0.42446762048011771329 0.17427360432316915673 -0.18551836958134962363 0.13074745200077370066 -0.63687784591122809097 -0.10424881944292106739 -0.78805952588376537715 -0.41035039784122456785 -0.15673047668122941367 1.9848026553606630262 -0.92028305234442708826 0.95474975478419987773 0.33833271279979498791 1.039612284574334522 -0.44905933528577374192 0.11343429632578223842 0.078146856765112820975 -0.14588973270538402316 0.31676187779015940738 -0.12315800850754209106 0.1161555800624436835 0.032347469141394469272 -0.073836122489371200373 -0.048184906907938709897 0.19132697293756345536;-0.09541426501113280112 0.11461104011184471141 1.0507357614205361518 -1.6749936250077721578 0.30421538692144017846 1.3909204344069701076 0.86383201450354696327 -0.37430724953860255999 -0.055193185880702461121 -0.29338182737322376914 0.63364289600763967769 -0.37154220687823968916 -0.062838235254852700673 -0.095637468130525163379 -0.32789272170000188789 0.77704361078147721198 0.079155849235464079139 -0.3855531620608468879 -0.7984265904798492075 -0.20142458908702090548 0.056566368672118935712 -0.51227018867484330755 0.56186270073648036938 0.2943095264296348712 0.2679029807100258842 0.41549555791608860922 -0.78507827872529378777 0.29328330875690911128 -0.051725003678794553852 0.012433243020038935861 0.26420227528143203077 0.20395818908523810631 0.2647534309835106181 0.13201392938304412628;0.45717886487533970774 -0.031829429404989444119 -0.2205377333343985502 -0.075842397645291784181 -0.12633530079423097026 -1.4778436106889367707 -0.090039038517792463479 0.12954432563057755035 0.29314251548970526873 1.2595842215611796622 -1.828361707966356553 0.0087377238115363842913 0.4816065107625754349 -0.50489922977286427752 -1.0937624200311051315 0.47794598228014850694 0.31875149295761223689 1.554991200874491053 1.4277232946766214017 -0.60308795003399584544 -0.17691361109561348774 -0.11387240466101447578 -0.41916795427251024586 -0.23167936086592735845 0.055824897098145011276 -0.41180323815903857598 1.0630876841534480093 -1.679286318909522846 -0.040935594265369565359 0.81295124781973981953 -1.6879465325389184649 0.51571931538813320373 0.062312633465084053819 0.47140373621846870522;-0.40602049438258092096 0.66465345662395824977 0.66945292568042225057 0.11668376045852299483 0.21360042980619264874 -0.25625235883600144815 0.97727779732768516041 -0.18204307960611831874 -0.050702139529623276026 -0.2421291169714056557 0.4182808213656907248 -0.12772664936271657665 0.1613276553699002358 -0.2232514060470695838 -0.58165838634585997902 1.6607502679833079373 -0.64644859789994835175 -0.32155979053493771724 -0.13292234948378817139 0.3605078204120312213 -0.036408863795786367001 -0.45167002530269118044 0.52920867510708335946 0.28018509300884053559 0.3759369969843088799 0.10750337942451014539 -0.13549237146447351554 0.21171826921291647672 0.19017273012999455495 -0.30229235269109500095 0.24590079263540037813 -0.15811614808302323909 0.69848431331720961524 0.0038508855471234095837;-0.16839702632554578998 0.42749716284663308308 0.5250479531607481487 -0.38667690048064301545 -0.058822347742432182227 -0.31475948810782156118 0.28080998925103234365 0.31202582058235844853 0.13267988853738518773 -0.35719705291613007558 0.43042975227498214696 -0.15572515751508700377 -0.16652931684298161175 -0.1189159467567316858 0.11352317733046131398 0.33365202323727871647 -0.54942110542415634189 -0.46325654126041171388 -0.65515069328177100161 -0.45606342048226639063 0.71334494898068667723 -1.3543834419587950091 -0.81828369803909761782 -0.30208607953302529792 -0.25947717475748599547 -0.03320310007802805552 -0.22487064399320941255 0.3535997517875899554 0.14365470875905614334 -0.2938949777997905688 0.17229884683093399378 0.066357406512966454759 -0.10150723316582406508 0.1916497275773052511;0.27732843768616932678 3.8270051360864409951 -0.4678093949233740334 -1.1223563686447639576 -2.0790903186073421693 2.8055703571148078446 -2.8789787690145072219 -0.42683590235168622495 0.18751627694750325204 -0.14779708421692244746 -0.23224100568092290175 -0.31401081182149220838 0.32698271534096912116 0.17720079616156511615 -0.37288559789339648098 0.49889329318683678371 0.56974429915083357745 3.3590684494969118568 -0.80258072241500699739 -0.18312510576138549268 0.0155425755433747214 2.5356952116219777515 -0.91010948197082108813 0.017221014411139632522 -0.31592504453455338975 0.55036561256065763548 -0.62165031419475069718 0.15655191870662776843 -0.57639104324097811816 0.3515583733437070979 0.052997102382750765903 -0.20601869031169564583 -1.781654867755488203 0.11870893987189488905;-0.84460092847586409892 -0.5126329255794194184 0.31640714823942434064 0.069878927642554683475 0.33954665264261640889 1.481002050806625725 -1.5844839382913520343 -0.23783446605584743216 -0.19462147630884665817 -0.16633642025942751985 -0.29736688855693355071 0.17599091578083103649 0.093756974938948217657 -0.067850852440257555798 0.72628314112980596473 -0.03270190999709984836 -1.09443059328249781 0.51079424962857755688 0.3714501140277032265 -2.214858104037241926 -0.075581800441882285302 -0.2170516524791500923 -0.68036230617993675995 -0.10630050994178870394 0.27726038466931141047 0.26894596937572912143 -0.1028042034322039916 -0.00085213746032499490882 -0.1121501523037476411 0.051065063470079247177 -0.20252908955021059478 0.10599085291064912207 1.5328783102211742673 0.031048215458122193494;0.0028471937694982802323 -0.9341636673286590753 -0.14339284762020679254 0.037254218136573105657 -1.3650228961790080717 1.657939772974099446 -1.6050583837120022679 0.014938809309067895351 0.40622796018276968733 -0.31367536144601809722 0.061195842690717865142 0.21486238243433611328 0.16462414383247084282 -0.015871323342156039293 1.0564767135630381834 0.53198891405693526924 -0.51451013619516894337 2.7725929335413752597 0.40285463197483595277 -1.2030018677936360483 0.76590710413521412292 -1.4423544152601039947 1.7130212469885195414 -0.055700432593791690539 0.18261031569185487422 -0.13900198371172978185 0.12827659229879370684 -0.17322244834656638779 0.32708323156711383017 0.028850205778184163236 0.029649069615789624271 -0.059617036713663050518 0.50022406410518005515 0.35898900897804891796;0.026445618697344523002 -0.72006412987621071231 0.37875516224412242305 0.19607172741571848862 0.74283841086856516878 -0.2697708589591916728 0.083973295721965116045 0.39156136995485874008 -0.3534602393948214627 0.19165063931732159719 0.22675822794650768444 0.33294246959813061926 -0.41650676561124105879 -0.14095937924615398185 0.28756097768052035768 0.77100024619391938074 -0.40206559154357718322 -0.0016431002085511316451 0.68145450501901005946 -2.2553834468953768422 0.91559935896363953134 -2.3915951643589488107 1.5385624766150862719 -0.16069227987151349368 0.091423328315047111547 -0.50022157896763785878 -0.093877756165156450718 0.061420493341564741385 -0.27539470540473598437 -0.25427273770522990093 -0.32476683788158072774 0.064539761289520228282 3.1292803665302466598 0.69340865953533248334;-0.30369239566533895447 -1.0391946955401045738 0.16949768752059221621 0.60917901164071530662 0.24290676998273200149 0.81378843726309280093 1.7351129187693528078 -0.108466272215851256 0.1501204997164596322 -0.46686209262547062604 -0.37790175574588441565 -0.02544126003030761779 0.2370283167103629518 -0.48049194644225873274 0.2343635448772677099 -0.18892590629653913115 -1.0851647413031595413 0.44210581503872520281 1.0808136275744442134 -0.077596499424386899957 0.022532081675170012591 -0.47391559654711207239 0.29969514753437626053 -0.31667213219293749438 -0.44975830847882025676 0.10141814985985864173 -0.62732873351000006945 -0.2572799569804305464 0.012829802253436474457 -0.36632788639689711774 -0.38867452524698636873 0.0028437298182108455662 -0.27898570320191246052 1.2949361867812785309;-0.27914928821716916696 0.0076288605149432090619 -0.24214289495991497825 -0.42769162521619902284 -0.65231764485326448888 -0.66053305365415060368 -0.45557563763608255325 -0.21216268444286881523 0.095017906222878714684 0.23930806399282922303 -0.025256949609182139521 0.066622406313490423191 -0.087847350216706657222 -0.082143554411349739564 0.46205000647037980377 -0.062762667342328243292 -0.20071463810077849743 0.04172724595610318582 0.29127668111701954246 -0.38764438995012973077 0.090800346776142279448 0.33885336989866493562 0.23275710751781283903 -0.15192096344910008265 0.35464360927162663639 -0.26148142996689799356 -0.062151091511635309095 0.22730989584876284959 -0.016659585274009441197 0.31267731956542615945 -0.037350020763083739694 0.088931660561658937292 -0.1637903358985112745 0.22981345797250024576;0.89290810683760790667 1.802371151644113878 -0.19369048098919389167 0.77183369237797749829 -0.91752101081170067687 4.2347600627400341367 -0.47617594319118139445 -0.12858995086045235667 0.26263602364822452584 1.9500781458781228928 -0.82136576876609790343 -0.5825487680010285052 0.5318618182284631235 -0.64855601575626842248 0.29589064457007474562 -0.24086520179338602454 -0.50845906298786114341 2.3065507793971011807 1.5204313665473752071 -2.1332191520696976994 1.4321570937997003536 -0.93769948853775220154 -0.096783661615157265401 -1.6552034514831757139 0.21030699104141628575 -2.0571417208558764322 -0.18934066882470013127 -2.2007703681517996053 -0.35632576983518610136 -0.071258515960996082761 -1.302062978758763645 0.38204176869861661281 0.15003610844441189753 2.6691182524925922692;-0.70274706756867466595 -0.36509694506914808221 0.42244413620823367816 0.51871718628771201764 1.9086383720599684466 1.1870615109436808421 0.37071380160869876752 -0.19681721516111680415 -0.1899644365507998367 -0.32938044631433049947 -0.85984921948932591107 -0.045007201705083689502 -0.0012878164725098585012 -0.069926666412959068153 1.3058610088125157667 1.683242436530545616 -1.571777532541755118 -1.8921704016744338439 -0.2668756292366156746 -0.34671202764213127079 0.55657458846552398946 -0.70905225988840003826 0.35672789574698071657 -0.35035885660441584699 0.27871022383807969591 0.26330108682325770175 -0.44480990449342694415 0.63714974533157309189 -1.0322095751041595602 0.37468802891740182748 -0.79987548851805911898 0.62769688648569832434 -2.0776082893205320978 -0.15758978817940816342;-1.0803087983060806199 -0.1065721475215379993 -0.39280051428524170865 0.023511168210359326136 -4.2105048650751513151 0.088893433511471886543 -1.7947950467091613458 0.059191280532753506871 0.19118935608717141372 -0.14513309593687970245 0.056027314140182644941 -0.11251993215553433847 0.024728117858394661754 -0.46295506900678623508 2.3891931131976642533 -0.72940014839066058538 -0.99600147355278334516 -2.8943777668284464966 0.34271529829849572968 -0.71349058778817020521 -0.85958906869692353059 1.9394755836018600093 -2.8838617450675543274 0.33652755885701407523 0.028187729704306441203 0.29718593309992263896 0.12607814620781601644 0.46364500992054319406 0.80823289011033760953 -0.54851154725960071801 0.24183289363239335312 0.55294221161696399669 2.3536963992686867897 -1.364716133035974277;0.29170621447912237212 0.12768275277858495698 -0.33662880814785645089 0.73629719303702612088 -0.52988719267708794813 -0.1543570014947703295 -0.60174240833374970094 0.51952019651264558231 0.28242308367908203204 -0.35144331982918403101 0.56273223028133523282 -0.16747968588110004329 0.034885184600861270099 0.051470699572393127652 -0.076593649820179188215 -0.17959286911820274146 -0.096614334358733136576 -0.007761431886934296899 -0.12709793197429281042 -0.95005240629046472378 -0.26380814040444244828 -0.084962197734610001021 -0.51032351430112365964 0.0022827294126482162127 -0.045044947316711984875 -0.24224847614521136108 -0.14456545092988787315 0.12635839592018735522 0.16247929401898586477 -0.28361910689495212212 0.25542684136924681537 0.027524047596214067102 0.23548074847731420567 0.0023408220223319958428;0.34922585612275997002 -0.16918709861734720912 -1.0141799001170259675 0.14016384633802400628 -0.44879891671714194912 -0.075541606250682680201 0.058759823296112914659 0.22380342491224161638 -0.27381888524147030006 -0.09246473239474238548 0.45394149976170017347 0.32758427298985315357 -0.05769298921736402963 0.50749613828894724055 -0.040129060291454153597 0.047585025472902442445 0.28113036012098546745 -2.5806996099849057735 -0.94456523259123581493 0.2006353436721947936 -2.5520593552255688152 2.1781984438460177955 -1.1716090657152691268 0.63020241351796524309 0.17826607403355515524 0.11517981269169121072 -0.029161387877467703084 0.2326189170832803077 -0.3620896019913596442 0.62919169970090005339 0.49044847229390886589 -0.28832230438525247029 1.3795256074796224954 -0.12278078388097765639;-0.37070801987507712161 -0.84325309982583018797 0.34335045172544909065 -0.032937939859112121133 -0.24517955887433914852 -0.40740308266232805323 0.60475741225921075817 -0.43537403887781184197 0.10779416073145878241 0.042843590882252584329 0.2219599112993977108 -0.25493529115344315539 0.049892512408654721145 -0.36387796126663968233 -0.22142284609696361031 0.76830592573321576655 0.35431543534065740308 0.42273837424481475189 0.49359536440756773823 -0.042213924126583375618 1.0383133770878647528 -0.87819870710105951694 0.038794313415338531337 0.18000435981519283257 -0.23750698775189088563 0.020149314102346372463 -0.12311929873073530761 0.10741981935419975258 0.44462746570419253711 -0.18815985110540553449 -0.20982830058088092207 0.17750761170537454614 0.1083002841747607442 0.10772617025011656244;0.086880767871742398123 3.6420079125676689813 1.0003786546082642506 0.16656287910604153368 -0.25922778716828381862 1.5834367894568326385 -0.40775702135497499112 -0.28367275458666757482 0.38855425282721234304 1.231286164690057916 0.046446868283420220114 0.31938665316397052418 -0.20167493324548696476 0.045162357413031720133 0.23967529368620016372 1.8451077837728615538 -0.42077428191525184653 -1.4876858539620199107 2.0958393248706479461 -2.2978706669478841107 1.7849819910000923606 -0.11314968906249246727 -0.53562410856113651381 -1.3245465918742744815 -0.22368919405263398836 -1.3422226609507470485 0.39032922133486730454 0.11228196253810650285 -0.29143497992859074275 -0.2515518545112820914 -0.42795240066968920356 0.32300992212692775096 -0.22973511611648497754 0.28137160782118447733;0.039287292963286840619 -2.0401810661379928824 -0.57919394690910253054 -0.92750242445872721486 -0.22140976647499602259 -0.66016950063602297671 1.9443364791679178527 -0.45537048397137641631 0.13990166893891164968 0.87991852279604509945 0.57863314835963630678 0.052849329611455907185 -0.19157554510645383172 0.97421838439985575242 -0.20835470501210617833 -1.5297079534169506498 -0.89489691276098359829 -0.45822504742969494274 -0.83732058615654114675 0.18097770211067934487 -0.76834778729241026696 0.59696520574942191217 -0.29588993612631220298 -0.23828920405395953575 0.31490869504497076559 -0.69651779266697089188 0.20941404165403615378 -0.31431947502833884611 -0.56600658334003806083 0.27855224369899178605 0.54953802982693367163 -0.57377113147910452362 -1.9799331463105698248 0.36085648464746727937;-0.071829886757388425322 0.22265436811117278459 0.00839503844248204803 0.18661927370640435386 -0.87136187333196035709 2.2362734762051079684 -0.62985106937217361089 -0.10531906418837073958 -0.033346019717285936557 0.33445193566775693883 -0.30461760406136889623 -0.1734611280807418221 0.18724389345701003551 0.01328109420952401816 0.36554115349136251378 0.10715905027536651306 0.65508964961946813954 1.8076620623142214406 -0.334128846993304085 0.10564258128907064171 1.3964665475623072588 -0.69131203925892614759 -0.094028765894921054191 -0.26829607630983648425 -0.19234899573607389112 -0.34924574498492749752 0.29403525751677961342 -0.19057203303443848164 -0.15768628767564571436 0.049171865855575480619 -0.2065389263791480301 -0.27943097432670921387 0.43638185687815778113 0.60226609488822502314;-0.29488669903144698603 -0.070668198605182405703 2.2579412964005229902 -3.0176897906963651153 1.297876713077151356 -1.3990133996246125747 2.5982544792063744232 -0.01580810862819877205 0.28261358527401359009 -2.6605784792224165258 2.0229277342054170497 -0.12046962636960888149 -0.083208992792421790363 -1.1253967385448515603 0.80757850737886804904 0.39414287616537174719 -0.97217974381221816671 -0.78346425154005228109 3.0400963377120788778 1.7694717670316115754 1.0112957878945654233 0.96329465305879224957 0.042741495890764924503 0.45099316331780581191 -0.16890937924066784515 1.927787292463535529 -1.8402689901976958531 2.6397434751874051528 1.3679680990638320992 -1.3105766297797938336 1.1934971225909993819 0.28214501906927447195 -8.8770508092881517115 -2.4307528917708109972];
  
  % Layer 2
  b2 = [0.86281655750107344449;-0.37580733989202541601;-1.4565042541068520254];
  LW2_1 = [0.9837432399030550112 -1.313996593203661245 -1.0520705527590343831 -0.69381928569012729646 0.093831262336261267443 1.3963379736351810845 0.12874178301528263479 2.0347408331606366971 0.89637423196931442781 0.09620893701582279578 -0.28584787312846310359 -0.4772747777854577933 -1.6037457531707732805 -0.024636295236430075933 0.94197717640116929161 -0.48878156016734675138 -0.88850501663107783745 1.9144655981243290377 1.0078419689037534379 0.43227012426013478041 0.62004561850094586095 -0.53696473621496676465 0.87259142338989847953 0.37422649450519029912 0.85034315643066515911;-0.55556847378987039843 0.24472745602575973756 -0.1427891379261124194 -0.12250457793372328263 -0.32022834127034272012 -0.26118919516757088672 -0.083790772711992603239 0.0065157179786354381748 -0.70477026510827311956 0.72756682277050155339 1.2357711655251895078 0.51667123917918356124 -0.70580749077310744877 -1.106816771958534229 -1.0718782558599726507 -0.16964766765349867383 0.29226825153333962914 0.035283226370943721051 -1.0004828504952818502 -0.2786853461362633344 1.0971188267617602019 -0.75772750068527139344 -0.14310418691782883505 0.66959365286620642355 0.29033198295718620763;-0.0011105368164050467231 0.6382898673023348346 0.17806257343149453631 1.104720445364046455 -1.3766020500935272075 0.53806590096989259653 1.357240471963005124 -0.14067336138991159977 0.065917520390735909186 0.92581980035128097484 0.94405339809975541421 0.35388632272241055121 -0.35359595656570824707 0.6046900906035351797 -1.4593002385160793732 -0.99257795223301470422 0.50446352949428940882 -0.40216673285647908109 -2.77126659265392572 -0.32336636301856513942 -0.79095853281794936684 0.39521307942126354673 -0.70813893126178206749 -2.6144566501809474168 -0.7638611477157793983];
  
  % ===== SIMULATION ========
  
  % Format Input Arguments
  isCellX = iscell(X);
  if ~isCellX, X = {X}; end;
  
  % Dimensions
  TS = size(X,2); % timesteps
  if ~isempty(X)
    Q = size(X{1},2); % samples/series
  else
    Q = 0;
  end
  
  % Allocate Outputs
  Y = cell(1,TS);
  
  % Time loop
  for ts=1:TS
  
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
  end
  
  % Final Delay States
  Xf = cell(1,0);
  Af = cell(2,0);
  
  % Format Output Arguments
  if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
  y = bsxfun(@minus,x,settings_xoffset);
  y = bsxfun(@times,y,settings_gain);
  y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numer = exp(n);
  denom = sum(numer,1); 
  denom(denom == 0) = 1;
  a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
